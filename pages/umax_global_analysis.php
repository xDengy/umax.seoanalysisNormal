<?php
use Bitrix\Main\Loader;
use Umax\Lib\Internals\UmaxSeoAnalysisTable;
use Umax\Lib\Internals\UmaxSeoOnPageElementTable;
use Umax\Lib\Internals\UmaxSeoPagesTable;
use Umax\Lib\Internals\UmaxMetasTable;
use Umax\Lib\Internals\UmaxIndexesTable;
use Umax\Lib\Internals\UmaxImagesTable;
use Umax\Lib\Internals\UmaxCommerceTable;

require_once($_SERVER["DOCUMENT_ROOT"]."/bitrix/modules/main/include/prolog_admin_before.php");
require_once($_SERVER['DOCUMENT_ROOT'].'/bitrix/modules/main/include/prolog_admin.php');
?>
<?
if (!Loader::includeModule('umax.seoanalysis') || \UmaxAnalysisDataManager::isDemoEnd()) {
    echo CAdminMessage::ShowOldStyleError("Модуль не установлен");
} else {
    function getUrls($arr) {
        if(is_array($arr))
            return trim($arr['loc']);
    }
    
    $seotable = UmaxSeoAnalysisTable::getList()->Fetch();
    $isEmpty = UmaxSeoAnalysisTable::checkIfEmpty($seotable);
    $summaryImages = UmaxImagesTable::getFilledImages();

    $seoOnPage['ALL'] = UmaxSeoOnPageElementTable::getList()->FetchAll();

    $seoOnPage['NORMAL'] = UmaxSeoOnPageElementTable::getList([
        'filter' => [
            '>FULL_VALUE' => 74
        ]
    ])->FetchAll();

    $seoOnPage['GOODS'] = UmaxSeoOnPageElementTable::getList([
        'filter' => [
            'IBLOCK_TYPE' => 'GOODS'
        ]
    ])->FetchAll();
    $seoOnPage['SERVICE'] = UmaxSeoOnPageElementTable::getList([
        'filter' => [
            'IBLOCK_TYPE' => 'SERVICE'
        ]
    ])->FetchAll();
    $seoOnPage['NEWS'] = UmaxSeoOnPageElementTable::getList([
        'filter' => [
            'IBLOCK_TYPE' => 'NEWS'
        ]
    ])->FetchAll();

    $pages = [];
    $files = scandir($_SERVER["DOCUMENT_ROOT"] . '/');
    foreach($files as $file) {
        if(str_contains($file, 'sitemap') && str_contains($file, '.xml')) {
            $name = $_SERVER["DOCUMENT_ROOT"] . '/' . $file;
            if(file_exists($name)) {
                $sitemapfile = file_get_contents($name); 
                $xml = simplexml_load_string($sitemapfile);
                $con = json_decode(json_encode($xml), true);
                if(array_key_exists('url', $con)) {
                    $getUrlsAr = array_map('getUrls', $con['url']);
                    $pages = array_merge($pages, $getUrlsAr);
                }
            }
        }

        $i++;
    }
    $pages = array_filter($pages, fn($value) => !is_null($value) && $value !== '');
    $pages = array_unique($pages, SORT_REGULAR);
    $pages = count($pages);

    $data = [
        'SEO OnPage' => json_encode(UmaxSeoOnPageElementTable::getListEncode(['select' => ['page_url', 'IBLOCK_TYPE', 'FULL_VALUE']])),
        'Страницы' => json_encode(UmaxSeoPagesTable::getListEncode(['select' => ['page_url', 'responce', 'PAGES_INDEX']], ['PAGES_INDEX'])),
        'Мета теги' => json_encode(UmaxMetasTable::getListEncode()),
        'Индексация' => json_encode(UmaxIndexesTable::getListEncode()),
        'Изображения' => json_encode(UmaxImagesTable::getListEncode()),
        'Коммерция' => json_encode(UmaxCommerceTable::getListEncode()),
    ];
?>
    <div class="container" id="analysis">
        <div class="header">
            <div class="date">
                <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://startAnglew.w3.org/2000/svg">
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M21.875 25C22.7038 25 23.4987 24.6708 24.0847 24.0847C24.6708 23.4987 25 22.7038 25 21.875C25 21.0462 24.6708 20.2513 24.0847 19.6653C23.4987 19.0792 22.7038 18.75 21.875 18.75C21.0462 18.75 20.2513 19.0792 19.6653 19.6653C19.0792 20.2513 18.75 21.0462 18.75 21.875C18.75 22.7038 19.0792 23.4987 19.6653 24.0847C20.2513 24.6708 21.0462 25 21.875 25ZM21.875 26.25C23.0353 26.25 24.1481 25.7891 24.9686 24.9686C25.7891 24.1481 26.25 23.0353 26.25 21.875C26.25 20.7147 25.7891 19.6019 24.9686 18.7814C24.1481 17.9609 23.0353 17.5 21.875 17.5C20.7147 17.5 19.6019 17.9609 18.7814 18.7814C17.9609 19.6019 17.5 20.7147 17.5 21.875C17.5 23.0353 17.9609 24.1481 18.7814 24.9686C19.6019 25.7891 20.7147 26.25 21.875 26.25Z" fill="black"/>
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M21.875 19.6875C22.0408 19.6875 22.1997 19.7533 22.3169 19.8706C22.4342 19.9878 22.5 20.1467 22.5 20.3125V21.6163L22.9419 22.0581C23.0557 22.176 23.1187 22.3339 23.1173 22.4978C23.1159 22.6616 23.0501 22.8184 22.9343 22.9343C22.8184 23.0501 22.6616 23.1159 22.4978 23.1173C22.3339 23.1187 22.176 23.0557 22.0581 22.9419L21.25 22.1338V20.3125C21.25 20.1467 21.3158 19.9878 21.4331 19.8706C21.5503 19.7533 21.7092 19.6875 21.875 19.6875ZM8.75 14.375H7.5V15.625H8.75V14.375ZM7.5 13.125C7.16848 13.125 6.85054 13.2567 6.61612 13.4911C6.3817 13.7255 6.25 14.0435 6.25 14.375V15.625C6.25 15.9565 6.3817 16.2745 6.61612 16.5089C6.85054 16.7433 7.16848 16.875 7.5 16.875H8.75C9.08152 16.875 9.39946 16.7433 9.63388 16.5089C9.8683 16.2745 10 15.9565 10 15.625V14.375C10 14.0435 9.8683 13.7255 9.63388 13.4911C9.39946 13.2567 9.08152 13.125 8.75 13.125H7.5ZM13.75 14.375H12.5V15.625H13.75V14.375ZM12.5 13.125C12.1685 13.125 11.8505 13.2567 11.6161 13.4911C11.3817 13.7255 11.25 14.0435 11.25 14.375V15.625C11.25 15.9565 11.3817 16.2745 11.6161 16.5089C11.8505 16.7433 12.1685 16.875 12.5 16.875H13.75C14.0815 16.875 14.3995 16.7433 14.6339 16.5089C14.8683 16.2745 15 15.9565 15 15.625V14.375C15 14.0435 14.8683 13.7255 14.6339 13.4911C14.3995 13.2567 14.0815 13.125 13.75 13.125H12.5ZM18.75 14.375H17.5V15.625H18.75V14.375ZM17.5 13.125C17.1685 13.125 16.8505 13.2567 16.6161 13.4911C16.3817 13.7255 16.25 14.0435 16.25 14.375V15.625C16.25 15.9565 16.3817 16.2745 16.6161 16.5089C16.8505 16.7433 17.1685 16.875 17.5 16.875H18.75C19.0815 16.875 19.3995 16.7433 19.6339 16.5089C19.8683 16.2745 20 15.9565 20 15.625V14.375C20 14.0435 19.8683 13.7255 19.6339 13.4911C19.3995 13.2567 19.0815 13.125 18.75 13.125H17.5ZM8.75 19.375H7.5V20.625H8.75V19.375ZM7.5 18.125C7.16848 18.125 6.85054 18.2567 6.61612 18.4911C6.3817 18.7255 6.25 19.0435 6.25 19.375V20.625C6.25 20.9565 6.3817 21.2745 6.61612 21.5089C6.85054 21.7433 7.16848 21.875 7.5 21.875H8.75C9.08152 21.875 9.39946 21.7433 9.63388 21.5089C9.8683 21.2745 10 20.9565 10 20.625V19.375C10 19.0435 9.8683 18.7255 9.63388 18.4911C9.39946 18.2567 9.08152 18.125 8.75 18.125H7.5ZM13.75 19.375H12.5V20.625H13.75V19.375ZM12.5 18.125C12.1685 18.125 11.8505 18.2567 11.6161 18.4911C11.3817 18.7255 11.25 19.0435 11.25 19.375V20.625C11.25 20.9565 11.3817 21.2745 11.6161 21.5089C11.8505 21.7433 12.1685 21.875 12.5 21.875H13.75C14.0815 21.875 14.3995 21.7433 14.6339 21.5089C14.8683 21.2745 15 20.9565 15 20.625V19.375C15 19.0435 14.8683 18.7255 14.6339 18.4911C14.3995 18.2567 14.0815 18.125 13.75 18.125H12.5Z" fill="black"/>
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M5 7.5C5 7.33424 5.06585 7.17527 5.18306 7.05806C5.30027 6.94085 5.45924 6.875 5.625 6.875H8.75V5.625H5.625C5.12772 5.625 4.65081 5.82254 4.29917 6.17417C3.94754 6.52581 3.75 7.00272 3.75 7.5V22.5C3.75 22.9973 3.94754 23.4742 4.29917 23.8258C4.65081 24.1775 5.12772 24.375 5.625 24.375H18.2844C18.0178 23.9932 17.8142 23.5712 17.6813 23.125H5.625C5.45924 23.125 5.30027 23.0592 5.18306 22.9419C5.06585 22.8247 5 22.6658 5 22.5V7.5ZM21.25 17.5437C21.6646 17.4844 22.0854 17.4844 22.5 17.5437V7.5C22.5 7.00272 22.3025 6.52581 21.9508 6.17417C21.5992 5.82254 21.1223 5.625 20.625 5.625H18.75V6.875H20.625C20.7908 6.875 20.9497 6.94085 21.0669 7.05806C21.1842 7.17527 21.25 7.33424 21.25 7.5V17.5437ZM10 6.875H16.6019V5.625H10V6.875Z" fill="black"/>
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M22.5 11.25H5V10H22.5V11.25Z" fill="black"/>
                    <path d="M7.5 4.375C7.5 4.20924 7.56585 4.05027 7.68306 3.93306C7.80027 3.81585 7.95924 3.75 8.125 3.75C8.29076 3.75 8.44973 3.81585 8.56694 3.93306C8.68415 4.05027 8.75 4.20924 8.75 4.375V7.5C8.75 7.66576 8.68415 7.82473 8.56694 7.94194C8.44973 8.05915 8.29076 8.125 8.125 8.125C7.95924 8.125 7.80027 8.05915 7.68306 7.94194C7.56585 7.82473 7.5 7.66576 7.5 7.5V4.375ZM16.25 4.375C16.25 4.20924 16.3158 4.05027 16.4331 3.93306C16.5503 3.81585 16.7092 3.75 16.875 3.75C17.0408 3.75 17.1997 3.81585 17.3169 3.93306C17.4342 4.05027 17.5 4.20924 17.5 4.375V7.5C17.5 7.66576 17.4342 7.82473 17.3169 7.94194C17.1997 8.05915 17.0408 8.125 16.875 8.125C16.7092 8.125 16.5503 8.05915 16.4331 7.94194C16.3158 7.82473 16.25 7.66576 16.25 7.5V4.375Z" fill="black"/>
                </svg>
                <?if($isEmpty == false):?>
                    <?
                        $date = date_create($seotable['DATE_CHANGE']);
                        $date = date_format($date,"H:i:s d-m-Y");
                    ?>
                    <span class="date__text">
                        <?=$date?>
                    </span>
                    <span>
                        Просканировано <?=$seotable['SUMMARY_INDEX']?> из <?=$pages?> страниц
                    </span>
                <?else:?>
                    Не проводилось
                <?endif;?>
            </div>
            <div class="download">
                <a href="https://umax.agency/blog/instrukcziya-po-rabote-modulya-seo-analiz-bitrix-ot-umax" target="blank" class="download__btn download__btn__instructions">
                    Инструкция
                </a>
                <a href="/bitrix/admin/umax_global_analysis_post.php" class="download__btn download__check">
                    <div></div>
                    Обновить
                </a>
                <?if($isEmpty == false):?>
                    <a class="download__btn download__xls" id="allXLS">
                        <svg width="17" height="20" viewBox="0 0 17 20" fill="none" xmlns="http://startAnglew.w3.org/2000/svg">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M3.05428 0.0618766C2.5724 0.17852 2.07457 0.524193 1.7932 0.937524C1.72737 1.03421 1.62253 1.23636 1.56026 1.38675L1.44701 1.6602L1.43623 5.83023L1.42545 10.0003H1.23814C0.975205 10.0003 0.66133 10.1658 0.509724 10.3845L0.392299 10.5538L0.3814 13.3924C0.369135 16.5841 0.357415 16.4434 0.656486 16.6994C0.832936 16.8504 1.01052 16.914 1.25717 16.9143L1.41893 16.9145L1.436 17.6274C1.4517 18.2818 1.46151 18.362 1.55588 18.6044C1.75085 19.1053 2.09977 19.5019 2.55693 19.7421C3.07424 20.014 2.7067 19.9993 9.02885 19.9999C14.5947 20.0005 14.7431 19.9986 15.0389 19.923C15.2057 19.8803 15.4414 19.7892 15.5627 19.7205C15.8538 19.5556 16.2215 19.178 16.3778 18.8834C16.6392 18.3909 16.6232 18.8649 16.6232 11.6035V5.0199L14.1135 2.50995L11.6038 0L7.44338 0.00324227C3.99501 0.00593765 3.24386 0.015977 3.05428 0.0618766ZM11.0845 2.82234C11.0992 4.30855 11.1024 4.3625 11.1889 4.58145C11.3562 5.00517 11.6634 5.31252 12.0725 5.46561C12.2791 5.54292 12.3656 5.54702 13.7878 5.54702H15.2855L15.3127 9.5022C15.3276 11.6776 15.3341 14.5047 15.3272 15.7847L15.3146 18.1122L15.197 18.3022C15.1135 18.4372 15.0233 18.5212 14.8856 18.5921L14.6917 18.6919L9.14358 18.7024C5.17637 18.7098 3.53566 18.7004 3.38542 18.6692C3.22952 18.6369 3.13128 18.5851 3.00459 18.4683C2.77099 18.253 2.71658 18.054 2.71658 17.4152V16.9145H7.91328C13.6857 16.9145 13.2555 16.9347 13.5481 16.6496C13.8144 16.3901 13.8106 16.4365 13.8106 13.4676C13.8106 11.5832 13.7975 10.764 13.7652 10.6359C13.706 10.4008 13.4251 10.1036 13.2051 10.0434C13.0957 10.0135 11.5017 10.0006 7.88273 10.0005L2.71658 10.0003V6.04242C2.71658 2.67433 2.72513 2.05576 2.774 1.89122C2.84982 1.63582 3.07639 1.41293 3.32921 1.34496C3.47675 1.30527 4.33236 1.29378 7.2933 1.29171L11.0692 1.2891L11.0845 2.82234ZM10.7385 11.786C10.9623 11.8475 10.9668 11.8514 10.9475 11.9695C10.9367 12.0359 10.8993 12.1884 10.8644 12.3084L10.8009 12.5267L10.5819 12.4527C10.3006 12.3577 9.88411 12.3511 9.7143 12.439C9.56457 12.5164 9.49133 12.6742 9.5477 12.798C9.60723 12.9286 9.81555 13.068 10.1488 13.2C10.5271 13.3499 10.7055 13.4616 10.8861 13.6616C11.0735 13.869 11.1294 14.0511 11.106 14.378C11.0719 14.8542 10.8037 15.1606 10.2822 15.3193C10.0556 15.3883 9.94693 15.3975 9.55949 15.3809C9.14483 15.3631 8.78232 15.2868 8.68123 15.196C8.65384 15.1715 8.77799 14.5902 8.81947 14.5487C8.82783 14.5403 8.9303 14.5701 9.04721 14.615C9.35199 14.7318 9.85938 14.7591 10.0585 14.6693C10.227 14.5933 10.3183 14.435 10.2806 14.2846C10.2449 14.1422 10.0799 14.0015 9.83458 13.9041C8.98987 13.5688 8.71447 13.2904 8.71619 12.7738C8.719 11.936 9.64242 11.4849 10.7385 11.786ZM3.6652 12.139C3.76372 12.3485 3.89442 12.632 3.95563 12.7692L4.06693 13.0184L4.2381 12.6129C4.33225 12.3899 4.45936 12.1063 4.52053 11.9827L4.63182 11.7581H5.08465C5.43106 11.7581 5.53302 11.7696 5.51845 11.8069C5.50794 11.8338 5.28579 12.224 5.02476 12.6741C4.7637 13.1241 4.55909 13.5157 4.57007 13.5443C4.58815 13.5914 5.3536 14.9221 5.53685 15.225L5.61365 15.352H5.14192H4.67022L4.34256 14.6976L4.01493 14.0433L3.95134 14.1996C3.91638 14.2855 3.78684 14.5799 3.66352 14.8537L3.43925 15.3516L2.98026 15.3518C2.72779 15.3519 2.52126 15.3451 2.52126 15.3367C2.52126 15.3283 2.74978 14.922 3.02909 14.434C3.30839 13.9459 3.53691 13.5392 3.53691 13.5302C3.53691 13.5212 3.31718 13.1253 3.04862 12.6504C2.78006 12.1755 2.56032 11.7805 2.56032 11.7726C2.56032 11.7646 2.76861 11.7581 3.02319 11.7581H3.48605L3.6652 12.139ZM6.86661 13.2132L6.87684 14.6684L7.58975 14.679L8.30266 14.6896V15.0208V15.352H7.16982H6.03698V13.555V11.7581H6.44668H6.85637L6.86661 13.2132Z" fill="white"/>
                        </svg>
                        Скачать XLS
                    </a>
                    <a class="download__btn download__pdf" id="allPDF">
                        <svg width="19" height="21" viewBox="0 0 19 21" fill="none" xmlns="http://startAnglew.w3.org/2000/svg">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M2.58691 0.0954637C2.4226 0.16664 2.25197 0.322586 2.16349 0.482439C2.1047 0.588578 2.09759 0.90926 2.08778 3.88623L2.07696 7.17282L1.71667 7.19001C1.27723 7.21095 1.01487 7.31365 0.796925 7.55011C0.481595 7.8922 0.496947 7.70293 0.496947 11.2448C0.496947 14.3745 0.497338 14.3903 0.580428 14.57C0.790245 15.0238 1.12733 15.2285 1.71612 15.2598L2.0759 15.2789L2.08723 17.3734C2.09969 19.6716 2.08919 19.5701 2.33928 19.8076C2.59464 20.0502 2.10415 20.0343 9.34511 20.0343C16.5861 20.0343 16.0956 20.0502 16.3509 19.8076C16.601 19.5701 16.5905 19.6716 16.603 17.3734L16.6143 15.2789L16.9741 15.2598C17.5629 15.2285 17.9 15.0238 18.1098 14.57C18.1929 14.3903 18.1933 14.3745 18.1933 11.2448C18.1933 7.70293 18.2086 7.8922 17.8933 7.55011C17.6752 7.31345 17.4131 7.21095 16.9725 7.18993L16.6111 7.1727L16.6072 5.99568C16.6051 5.3483 16.5912 4.77468 16.5763 4.72096C16.544 4.60431 12.6918 0.188477 12.5424 0.0967919C12.448 0.038898 12.0024 0.0333508 7.58118 0.0347181C3.32902 0.0360463 2.7066 0.0436248 2.58691 0.0954637ZM11.9624 2.88429V4.9541L12.0764 5.08169L12.1904 5.20927L14.0101 5.22017L15.8299 5.23107V6.20655V7.18204H9.34511H2.86036V3.99826V0.814489H7.4114H11.9624V2.88429ZM9.34187 8.21944C10.4975 8.43938 11.0826 9.39959 10.7739 10.5697C10.6952 10.8678 10.5241 11.1524 10.3013 11.3557C9.86314 11.7554 9.40574 11.9077 8.55405 11.9375L7.97784 11.9576V12.988V14.0184H7.31351H6.64913L6.65917 11.1379L6.66917 8.25737L6.88403 8.22534C7.60989 8.11701 8.78887 8.1142 9.34187 8.21944ZM15.8075 8.21456C15.9563 8.24761 16.1521 8.30296 16.2427 8.33754L16.4073 8.40043L16.2751 8.91089C16.2023 9.19165 16.1346 9.42951 16.1247 9.43947C16.1147 9.44943 16.038 9.43018 15.9543 9.39666C15.5273 9.22579 14.7453 9.16727 14.2609 9.26993C13.1579 9.5037 12.6339 10.4413 12.9061 11.694C13.0384 12.303 13.5394 12.8062 14.1666 12.96C14.3837 13.0133 15.0077 13.02 15.1853 12.9709L15.3025 12.9385L15.3132 12.326L15.324 11.7135H14.8737H14.4235V11.2057V10.6979H15.5173H16.6111V12.2224V13.7469L16.5037 13.7885C16.2561 13.8845 15.5407 14.0207 15.0592 14.0636C14.2214 14.1383 13.526 14.0328 12.9 13.7361C12.6258 13.6062 12.5099 13.5201 12.235 13.2419C11.8786 12.8812 11.6748 12.5356 11.5487 12.0779C11.4507 11.7222 11.4309 10.8969 11.511 10.5018C11.7654 9.24602 12.6408 8.44364 14.0505 8.17401C14.4014 8.1069 15.4296 8.13061 15.8075 8.21456ZM5.54638 10.3365C5.53376 12.2648 5.52434 12.5413 5.46403 12.7488C5.24651 13.497 4.82212 13.9139 4.12997 14.0592C3.70029 14.1494 2.59996 14.0952 2.52902 13.9804C2.50569 13.9427 2.62922 12.992 2.66234 12.9542C2.67629 12.9383 2.74856 12.9431 2.82286 12.9649C2.8972 12.9866 3.10061 13.0059 3.27488 13.0078C3.81702 13.0135 4.04824 12.8547 4.16829 12.3938C4.21759 12.2045 4.22763 11.8313 4.22763 10.1883C4.22763 9.10066 4.23935 8.19901 4.25368 8.18471C4.26798 8.17038 4.56792 8.15866 4.92013 8.15866H5.5606L5.54638 10.3365ZM8.06574 9.16286L7.97784 9.17977V10.056V10.9323H8.34446C8.82051 10.9323 9.07498 10.8523 9.29335 10.6343C9.47344 10.4544 9.54035 10.2752 9.53934 9.97517C9.53809 9.59155 9.32108 9.30638 8.94551 9.19485C8.75988 9.13969 8.27704 9.12215 8.06574 9.16286ZM15.8299 17.1435V19.0187H9.34511H2.86036V17.1435V15.2684H9.34511H15.8299V17.1435Z" fill="white"/>
                        </svg>
                        Скачать
                    </a>
                <?endif;?>
            </div>
        </div>
        <?if($isEmpty == false):?>
            <div class="main">
                <div class="main__group">
                    <div class="main__element" id="summary">
                        <div class="element__title">
                            Сводка
                            <span class="element__label">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M10 18.75C7.67936 18.75 5.45376 17.8281 3.81282 16.1872C2.17187 14.5462 1.25 12.3206 1.25 10C1.25 7.67936 2.17187 5.45376 3.81282 3.81282C5.45376 2.17187 7.67936 1.25 10 1.25C12.3206 1.25 14.5462 2.17187 16.1872 3.81282C17.8281 5.45376 18.75 7.67936 18.75 10C18.75 12.3206 17.8281 14.5462 16.1872 16.1872C14.5462 17.8281 12.3206 18.75 10 18.75ZM10 20C12.6522 20 15.1957 18.9464 17.0711 17.0711C18.9464 15.1957 20 12.6522 20 10C20 7.34784 18.9464 4.8043 17.0711 2.92893C15.1957 1.05357 12.6522 0 10 0C7.34784 0 4.8043 1.05357 2.92893 2.92893C1.05357 4.8043 0 7.34784 0 10C0 12.6522 1.05357 15.1957 2.92893 17.0711C4.8043 18.9464 7.34784 20 10 20V20Z" fill="#9B9B9B"/>
                                <path d="M7.27292 7.65832C7.27154 7.69267 7.27682 7.72694 7.28844 7.75905C7.30006 7.79115 7.31776 7.82041 7.34046 7.84501C7.36317 7.86961 7.39039 7.88904 7.42046 7.90211C7.45053 7.91518 7.48281 7.9216 7.51531 7.92099H8.34508C8.48387 7.92099 8.59451 7.80082 8.61261 7.65513C8.70313 6.95751 9.15573 6.44919 9.96237 6.44919C10.6523 6.44919 11.284 6.81395 11.284 7.69129C11.284 8.36658 10.9078 8.6771 10.3134 9.14927C9.6365 9.66929 9.10042 10.2765 9.13864 11.2623L9.14165 11.4931C9.14271 11.5629 9.16967 11.6294 9.21671 11.6783C9.26375 11.7273 9.3271 11.7547 9.3931 11.7547H10.2088C10.2755 11.7547 10.3394 11.7267 10.3866 11.6768C10.4337 11.627 10.4602 11.5594 10.4602 11.4888V11.3772C10.4602 10.6136 10.7348 10.3914 11.4761 9.7969C12.0886 9.30453 12.7272 8.75792 12.7272 7.61047C12.7272 6.00361 11.4439 5.22729 10.0388 5.22729C8.76449 5.22729 7.36847 5.85473 7.27292 7.65832V7.65832ZM8.83891 13.7869C8.83891 14.3538 9.26637 14.7727 9.85475 14.7727C10.4673 14.7727 10.8887 14.3538 10.8887 13.7869C10.8887 13.1999 10.4663 12.7873 9.85374 12.7873C9.26637 12.7873 8.83891 13.1999 8.83891 13.7869Z" fill="#9B9B9B"/>
                                </svg>
                                <div class="element__popup">
                                    Общая оценка оптимизации всего сайта
                                </div>
                            </span>
                        </div>
                        <div class="element__content">
                            <legend class="content__info" for="myCanvas" id="title"></legend>
                            <canvas class="content__canvas" id="myCanvas"></canvas>
                            <legend class="content__info circle" for="myCanvas" id="info">
                                <div class="info__element" style="padding: 7.5px 0px;">
                                    <span class="legend__head">Тип данных</span>
                                    <span style="margin-left: 5px;" class="legend__head">Количество</span>
                                </div>
                            </legend>
                        </div>
                    </div>
                    <div class="main__element">
                        <div class="element__title">
                            SEO OnPage
                            <span class="element__label">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M10 18.75C7.67936 18.75 5.45376 17.8281 3.81282 16.1872C2.17187 14.5462 1.25 12.3206 1.25 10C1.25 7.67936 2.17187 5.45376 3.81282 3.81282C5.45376 2.17187 7.67936 1.25 10 1.25C12.3206 1.25 14.5462 2.17187 16.1872 3.81282C17.8281 5.45376 18.75 7.67936 18.75 10C18.75 12.3206 17.8281 14.5462 16.1872 16.1872C14.5462 17.8281 12.3206 18.75 10 18.75ZM10 20C12.6522 20 15.1957 18.9464 17.0711 17.0711C18.9464 15.1957 20 12.6522 20 10C20 7.34784 18.9464 4.8043 17.0711 2.92893C15.1957 1.05357 12.6522 0 10 0C7.34784 0 4.8043 1.05357 2.92893 2.92893C1.05357 4.8043 0 7.34784 0 10C0 12.6522 1.05357 15.1957 2.92893 17.0711C4.8043 18.9464 7.34784 20 10 20V20Z" fill="#9B9B9B"/>
                                <path d="M7.27292 7.65832C7.27154 7.69267 7.27682 7.72694 7.28844 7.75905C7.30006 7.79115 7.31776 7.82041 7.34046 7.84501C7.36317 7.86961 7.39039 7.88904 7.42046 7.90211C7.45053 7.91518 7.48281 7.9216 7.51531 7.92099H8.34508C8.48387 7.92099 8.59451 7.80082 8.61261 7.65513C8.70313 6.95751 9.15573 6.44919 9.96237 6.44919C10.6523 6.44919 11.284 6.81395 11.284 7.69129C11.284 8.36658 10.9078 8.6771 10.3134 9.14927C9.6365 9.66929 9.10042 10.2765 9.13864 11.2623L9.14165 11.4931C9.14271 11.5629 9.16967 11.6294 9.21671 11.6783C9.26375 11.7273 9.3271 11.7547 9.3931 11.7547H10.2088C10.2755 11.7547 10.3394 11.7267 10.3866 11.6768C10.4337 11.627 10.4602 11.5594 10.4602 11.4888V11.3772C10.4602 10.6136 10.7348 10.3914 11.4761 9.7969C12.0886 9.30453 12.7272 8.75792 12.7272 7.61047C12.7272 6.00361 11.4439 5.22729 10.0388 5.22729C8.76449 5.22729 7.36847 5.85473 7.27292 7.65832V7.65832ZM8.83891 13.7869C8.83891 14.3538 9.26637 14.7727 9.85475 14.7727C10.4673 14.7727 10.8887 14.3538 10.8887 13.7869C10.8887 13.1999 10.4663 12.7873 9.85374 12.7873C9.26637 12.7873 8.83891 13.1999 8.83891 13.7869Z" fill="#9B9B9B"/>
                                </svg>
                                <div class="element__popup">
                                    Оптимизация каждой страницы отдельно
                                </div>
                            </span>
                        </div>
                        <div class="element__content circle">
                            <canvas class="content__canvas" id="seoOnPage"></canvas>
                            <legend class="content__info circle" for="seoOnPage" id="info">
                                <div class="info__element" style="padding: 7.5px 0px;">
                                    <span class="legend__head">Тип данных</span>
                                    <span style="margin-left: 5px;" class="legend__head">Проценты</span>
                                </div>
                            </legend>
                        </div>
                        <div class="element__btn">
                            <a class="download__btn download__xls">
                                <svg width="17" height="20" viewBox="0 0 17 20" fill="none" xmlns="http://startAnglew.w3.org/2000/svg">
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M3.05428 0.0618766C2.5724 0.17852 2.07457 0.524193 1.7932 0.937524C1.72737 1.03421 1.62253 1.23636 1.56026 1.38675L1.44701 1.6602L1.43623 5.83023L1.42545 10.0003H1.23814C0.975205 10.0003 0.66133 10.1658 0.509724 10.3845L0.392299 10.5538L0.3814 13.3924C0.369135 16.5841 0.357415 16.4434 0.656486 16.6994C0.832936 16.8504 1.01052 16.914 1.25717 16.9143L1.41893 16.9145L1.436 17.6274C1.4517 18.2818 1.46151 18.362 1.55588 18.6044C1.75085 19.1053 2.09977 19.5019 2.55693 19.7421C3.07424 20.014 2.7067 19.9993 9.02885 19.9999C14.5947 20.0005 14.7431 19.9986 15.0389 19.923C15.2057 19.8803 15.4414 19.7892 15.5627 19.7205C15.8538 19.5556 16.2215 19.178 16.3778 18.8834C16.6392 18.3909 16.6232 18.8649 16.6232 11.6035V5.0199L14.1135 2.50995L11.6038 0L7.44338 0.00324227C3.99501 0.00593765 3.24386 0.015977 3.05428 0.0618766ZM11.0845 2.82234C11.0992 4.30855 11.1024 4.3625 11.1889 4.58145C11.3562 5.00517 11.6634 5.31252 12.0725 5.46561C12.2791 5.54292 12.3656 5.54702 13.7878 5.54702H15.2855L15.3127 9.5022C15.3276 11.6776 15.3341 14.5047 15.3272 15.7847L15.3146 18.1122L15.197 18.3022C15.1135 18.4372 15.0233 18.5212 14.8856 18.5921L14.6917 18.6919L9.14358 18.7024C5.17637 18.7098 3.53566 18.7004 3.38542 18.6692C3.22952 18.6369 3.13128 18.5851 3.00459 18.4683C2.77099 18.253 2.71658 18.054 2.71658 17.4152V16.9145H7.91328C13.6857 16.9145 13.2555 16.9347 13.5481 16.6496C13.8144 16.3901 13.8106 16.4365 13.8106 13.4676C13.8106 11.5832 13.7975 10.764 13.7652 10.6359C13.706 10.4008 13.4251 10.1036 13.2051 10.0434C13.0957 10.0135 11.5017 10.0006 7.88273 10.0005L2.71658 10.0003V6.04242C2.71658 2.67433 2.72513 2.05576 2.774 1.89122C2.84982 1.63582 3.07639 1.41293 3.32921 1.34496C3.47675 1.30527 4.33236 1.29378 7.2933 1.29171L11.0692 1.2891L11.0845 2.82234ZM10.7385 11.786C10.9623 11.8475 10.9668 11.8514 10.9475 11.9695C10.9367 12.0359 10.8993 12.1884 10.8644 12.3084L10.8009 12.5267L10.5819 12.4527C10.3006 12.3577 9.88411 12.3511 9.7143 12.439C9.56457 12.5164 9.49133 12.6742 9.5477 12.798C9.60723 12.9286 9.81555 13.068 10.1488 13.2C10.5271 13.3499 10.7055 13.4616 10.8861 13.6616C11.0735 13.869 11.1294 14.0511 11.106 14.378C11.0719 14.8542 10.8037 15.1606 10.2822 15.3193C10.0556 15.3883 9.94693 15.3975 9.55949 15.3809C9.14483 15.3631 8.78232 15.2868 8.68123 15.196C8.65384 15.1715 8.77799 14.5902 8.81947 14.5487C8.82783 14.5403 8.9303 14.5701 9.04721 14.615C9.35199 14.7318 9.85938 14.7591 10.0585 14.6693C10.227 14.5933 10.3183 14.435 10.2806 14.2846C10.2449 14.1422 10.0799 14.0015 9.83458 13.9041C8.98987 13.5688 8.71447 13.2904 8.71619 12.7738C8.719 11.936 9.64242 11.4849 10.7385 11.786ZM3.6652 12.139C3.76372 12.3485 3.89442 12.632 3.95563 12.7692L4.06693 13.0184L4.2381 12.6129C4.33225 12.3899 4.45936 12.1063 4.52053 11.9827L4.63182 11.7581H5.08465C5.43106 11.7581 5.53302 11.7696 5.51845 11.8069C5.50794 11.8338 5.28579 12.224 5.02476 12.6741C4.7637 13.1241 4.55909 13.5157 4.57007 13.5443C4.58815 13.5914 5.3536 14.9221 5.53685 15.225L5.61365 15.352H5.14192H4.67022L4.34256 14.6976L4.01493 14.0433L3.95134 14.1996C3.91638 14.2855 3.78684 14.5799 3.66352 14.8537L3.43925 15.3516L2.98026 15.3518C2.72779 15.3519 2.52126 15.3451 2.52126 15.3367C2.52126 15.3283 2.74978 14.922 3.02909 14.434C3.30839 13.9459 3.53691 13.5392 3.53691 13.5302C3.53691 13.5212 3.31718 13.1253 3.04862 12.6504C2.78006 12.1755 2.56032 11.7805 2.56032 11.7726C2.56032 11.7646 2.76861 11.7581 3.02319 11.7581H3.48605L3.6652 12.139ZM6.86661 13.2132L6.87684 14.6684L7.58975 14.679L8.30266 14.6896V15.0208V15.352H7.16982H6.03698V13.555V11.7581H6.44668H6.85637L6.86661 13.2132Z" fill="#285FFA"/>
                                </svg>
                                Скачать XLS
                            </a>
                        </div>
                    </div>
                </div>
                <div class="main__line"></div>
                <div class="main__group">
                    <div class="main__element">
                        <div class="element__title">
                            Страницы
                            <span class="element__label">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M10 18.75C7.67936 18.75 5.45376 17.8281 3.81282 16.1872C2.17187 14.5462 1.25 12.3206 1.25 10C1.25 7.67936 2.17187 5.45376 3.81282 3.81282C5.45376 2.17187 7.67936 1.25 10 1.25C12.3206 1.25 14.5462 2.17187 16.1872 3.81282C17.8281 5.45376 18.75 7.67936 18.75 10C18.75 12.3206 17.8281 14.5462 16.1872 16.1872C14.5462 17.8281 12.3206 18.75 10 18.75ZM10 20C12.6522 20 15.1957 18.9464 17.0711 17.0711C18.9464 15.1957 20 12.6522 20 10C20 7.34784 18.9464 4.8043 17.0711 2.92893C15.1957 1.05357 12.6522 0 10 0C7.34784 0 4.8043 1.05357 2.92893 2.92893C1.05357 4.8043 0 7.34784 0 10C0 12.6522 1.05357 15.1957 2.92893 17.0711C4.8043 18.9464 7.34784 20 10 20V20Z" fill="#9B9B9B"/>
                                <path d="M7.27292 7.65832C7.27154 7.69267 7.27682 7.72694 7.28844 7.75905C7.30006 7.79115 7.31776 7.82041 7.34046 7.84501C7.36317 7.86961 7.39039 7.88904 7.42046 7.90211C7.45053 7.91518 7.48281 7.9216 7.51531 7.92099H8.34508C8.48387 7.92099 8.59451 7.80082 8.61261 7.65513C8.70313 6.95751 9.15573 6.44919 9.96237 6.44919C10.6523 6.44919 11.284 6.81395 11.284 7.69129C11.284 8.36658 10.9078 8.6771 10.3134 9.14927C9.6365 9.66929 9.10042 10.2765 9.13864 11.2623L9.14165 11.4931C9.14271 11.5629 9.16967 11.6294 9.21671 11.6783C9.26375 11.7273 9.3271 11.7547 9.3931 11.7547H10.2088C10.2755 11.7547 10.3394 11.7267 10.3866 11.6768C10.4337 11.627 10.4602 11.5594 10.4602 11.4888V11.3772C10.4602 10.6136 10.7348 10.3914 11.4761 9.7969C12.0886 9.30453 12.7272 8.75792 12.7272 7.61047C12.7272 6.00361 11.4439 5.22729 10.0388 5.22729C8.76449 5.22729 7.36847 5.85473 7.27292 7.65832V7.65832ZM8.83891 13.7869C8.83891 14.3538 9.26637 14.7727 9.85475 14.7727C10.4673 14.7727 10.8887 14.3538 10.8887 13.7869C10.8887 13.1999 10.4663 12.7873 9.85374 12.7873C9.26637 12.7873 8.83891 13.1999 8.83891 13.7869Z" fill="#9B9B9B"/>
                                </svg>
                                <div class="element__popup">
                                    Проценты всех страниц сайта и проверка индексации
                                </div>
                            </span>
                        </div>
                        <div class="element__content circle">
                            <canvas class="content__canvas" id="pages"></canvas>
                            <legend class="content__info circle" for="pages" id="info">
                                <div class="info__element" style="padding: 7.5px 0px;">
                                    <span class="legend__head">Тип данных</span>
                                    <span style="margin-left: 5px;" class="legend__head">Проценты</span>
                                </div>
                            </legend>
                        </div>
                        <div class="element__btn">
                            <a class="download__btn download__xls">
                                <svg width="17" height="20" viewBox="0 0 17 20" fill="none" xmlns="http://startAnglew.w3.org/2000/svg">
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M3.05428 0.0618766C2.5724 0.17852 2.07457 0.524193 1.7932 0.937524C1.72737 1.03421 1.62253 1.23636 1.56026 1.38675L1.44701 1.6602L1.43623 5.83023L1.42545 10.0003H1.23814C0.975205 10.0003 0.66133 10.1658 0.509724 10.3845L0.392299 10.5538L0.3814 13.3924C0.369135 16.5841 0.357415 16.4434 0.656486 16.6994C0.832936 16.8504 1.01052 16.914 1.25717 16.9143L1.41893 16.9145L1.436 17.6274C1.4517 18.2818 1.46151 18.362 1.55588 18.6044C1.75085 19.1053 2.09977 19.5019 2.55693 19.7421C3.07424 20.014 2.7067 19.9993 9.02885 19.9999C14.5947 20.0005 14.7431 19.9986 15.0389 19.923C15.2057 19.8803 15.4414 19.7892 15.5627 19.7205C15.8538 19.5556 16.2215 19.178 16.3778 18.8834C16.6392 18.3909 16.6232 18.8649 16.6232 11.6035V5.0199L14.1135 2.50995L11.6038 0L7.44338 0.00324227C3.99501 0.00593765 3.24386 0.015977 3.05428 0.0618766ZM11.0845 2.82234C11.0992 4.30855 11.1024 4.3625 11.1889 4.58145C11.3562 5.00517 11.6634 5.31252 12.0725 5.46561C12.2791 5.54292 12.3656 5.54702 13.7878 5.54702H15.2855L15.3127 9.5022C15.3276 11.6776 15.3341 14.5047 15.3272 15.7847L15.3146 18.1122L15.197 18.3022C15.1135 18.4372 15.0233 18.5212 14.8856 18.5921L14.6917 18.6919L9.14358 18.7024C5.17637 18.7098 3.53566 18.7004 3.38542 18.6692C3.22952 18.6369 3.13128 18.5851 3.00459 18.4683C2.77099 18.253 2.71658 18.054 2.71658 17.4152V16.9145H7.91328C13.6857 16.9145 13.2555 16.9347 13.5481 16.6496C13.8144 16.3901 13.8106 16.4365 13.8106 13.4676C13.8106 11.5832 13.7975 10.764 13.7652 10.6359C13.706 10.4008 13.4251 10.1036 13.2051 10.0434C13.0957 10.0135 11.5017 10.0006 7.88273 10.0005L2.71658 10.0003V6.04242C2.71658 2.67433 2.72513 2.05576 2.774 1.89122C2.84982 1.63582 3.07639 1.41293 3.32921 1.34496C3.47675 1.30527 4.33236 1.29378 7.2933 1.29171L11.0692 1.2891L11.0845 2.82234ZM10.7385 11.786C10.9623 11.8475 10.9668 11.8514 10.9475 11.9695C10.9367 12.0359 10.8993 12.1884 10.8644 12.3084L10.8009 12.5267L10.5819 12.4527C10.3006 12.3577 9.88411 12.3511 9.7143 12.439C9.56457 12.5164 9.49133 12.6742 9.5477 12.798C9.60723 12.9286 9.81555 13.068 10.1488 13.2C10.5271 13.3499 10.7055 13.4616 10.8861 13.6616C11.0735 13.869 11.1294 14.0511 11.106 14.378C11.0719 14.8542 10.8037 15.1606 10.2822 15.3193C10.0556 15.3883 9.94693 15.3975 9.55949 15.3809C9.14483 15.3631 8.78232 15.2868 8.68123 15.196C8.65384 15.1715 8.77799 14.5902 8.81947 14.5487C8.82783 14.5403 8.9303 14.5701 9.04721 14.615C9.35199 14.7318 9.85938 14.7591 10.0585 14.6693C10.227 14.5933 10.3183 14.435 10.2806 14.2846C10.2449 14.1422 10.0799 14.0015 9.83458 13.9041C8.98987 13.5688 8.71447 13.2904 8.71619 12.7738C8.719 11.936 9.64242 11.4849 10.7385 11.786ZM3.6652 12.139C3.76372 12.3485 3.89442 12.632 3.95563 12.7692L4.06693 13.0184L4.2381 12.6129C4.33225 12.3899 4.45936 12.1063 4.52053 11.9827L4.63182 11.7581H5.08465C5.43106 11.7581 5.53302 11.7696 5.51845 11.8069C5.50794 11.8338 5.28579 12.224 5.02476 12.6741C4.7637 13.1241 4.55909 13.5157 4.57007 13.5443C4.58815 13.5914 5.3536 14.9221 5.53685 15.225L5.61365 15.352H5.14192H4.67022L4.34256 14.6976L4.01493 14.0433L3.95134 14.1996C3.91638 14.2855 3.78684 14.5799 3.66352 14.8537L3.43925 15.3516L2.98026 15.3518C2.72779 15.3519 2.52126 15.3451 2.52126 15.3367C2.52126 15.3283 2.74978 14.922 3.02909 14.434C3.30839 13.9459 3.53691 13.5392 3.53691 13.5302C3.53691 13.5212 3.31718 13.1253 3.04862 12.6504C2.78006 12.1755 2.56032 11.7805 2.56032 11.7726C2.56032 11.7646 2.76861 11.7581 3.02319 11.7581H3.48605L3.6652 12.139ZM6.86661 13.2132L6.87684 14.6684L7.58975 14.679L8.30266 14.6896V15.0208V15.352H7.16982H6.03698V13.555V11.7581H6.44668H6.85637L6.86661 13.2132Z" fill="#285FFA"/>
                                </svg>
                                Скачать XLS
                            </a>
                        </div>
                    </div>
                    <div class="main__element" id="metaElement">
                        <div class="element__title">
                            Мета теги
                            <span class="element__label">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M10 18.75C7.67936 18.75 5.45376 17.8281 3.81282 16.1872C2.17187 14.5462 1.25 12.3206 1.25 10C1.25 7.67936 2.17187 5.45376 3.81282 3.81282C5.45376 2.17187 7.67936 1.25 10 1.25C12.3206 1.25 14.5462 2.17187 16.1872 3.81282C17.8281 5.45376 18.75 7.67936 18.75 10C18.75 12.3206 17.8281 14.5462 16.1872 16.1872C14.5462 17.8281 12.3206 18.75 10 18.75ZM10 20C12.6522 20 15.1957 18.9464 17.0711 17.0711C18.9464 15.1957 20 12.6522 20 10C20 7.34784 18.9464 4.8043 17.0711 2.92893C15.1957 1.05357 12.6522 0 10 0C7.34784 0 4.8043 1.05357 2.92893 2.92893C1.05357 4.8043 0 7.34784 0 10C0 12.6522 1.05357 15.1957 2.92893 17.0711C4.8043 18.9464 7.34784 20 10 20V20Z" fill="#9B9B9B"/>
                                <path d="M7.27292 7.65832C7.27154 7.69267 7.27682 7.72694 7.28844 7.75905C7.30006 7.79115 7.31776 7.82041 7.34046 7.84501C7.36317 7.86961 7.39039 7.88904 7.42046 7.90211C7.45053 7.91518 7.48281 7.9216 7.51531 7.92099H8.34508C8.48387 7.92099 8.59451 7.80082 8.61261 7.65513C8.70313 6.95751 9.15573 6.44919 9.96237 6.44919C10.6523 6.44919 11.284 6.81395 11.284 7.69129C11.284 8.36658 10.9078 8.6771 10.3134 9.14927C9.6365 9.66929 9.10042 10.2765 9.13864 11.2623L9.14165 11.4931C9.14271 11.5629 9.16967 11.6294 9.21671 11.6783C9.26375 11.7273 9.3271 11.7547 9.3931 11.7547H10.2088C10.2755 11.7547 10.3394 11.7267 10.3866 11.6768C10.4337 11.627 10.4602 11.5594 10.4602 11.4888V11.3772C10.4602 10.6136 10.7348 10.3914 11.4761 9.7969C12.0886 9.30453 12.7272 8.75792 12.7272 7.61047C12.7272 6.00361 11.4439 5.22729 10.0388 5.22729C8.76449 5.22729 7.36847 5.85473 7.27292 7.65832V7.65832ZM8.83891 13.7869C8.83891 14.3538 9.26637 14.7727 9.85475 14.7727C10.4673 14.7727 10.8887 14.3538 10.8887 13.7869C10.8887 13.1999 10.4663 12.7873 9.85374 12.7873C9.26637 12.7873 8.83891 13.1999 8.83891 13.7869Z" fill="#9B9B9B"/>
                                </svg>
                                <div class="element__popup">
                                    Проверка оптимизации мета-тегов на всех страницах
                                </div>
                            </span>
                        </div>
                        <div class="element__content meta">
                            <canvas class="content__canvas" id="meta"></canvas>
                            <legend class="content__info circle" for="meta" id="info">
                                <div class="element__btn">
                                    <a class="download__btn download__xls">
                                        <svg width="17" height="20" viewBox="0 0 17 20" fill="none" xmlns="http://startAnglew.w3.org/2000/svg">
                                            <path fill-rule="evenodd" clip-rule="evenodd" d="M3.05428 0.0618766C2.5724 0.17852 2.07457 0.524193 1.7932 0.937524C1.72737 1.03421 1.62253 1.23636 1.56026 1.38675L1.44701 1.6602L1.43623 5.83023L1.42545 10.0003H1.23814C0.975205 10.0003 0.66133 10.1658 0.509724 10.3845L0.392299 10.5538L0.3814 13.3924C0.369135 16.5841 0.357415 16.4434 0.656486 16.6994C0.832936 16.8504 1.01052 16.914 1.25717 16.9143L1.41893 16.9145L1.436 17.6274C1.4517 18.2818 1.46151 18.362 1.55588 18.6044C1.75085 19.1053 2.09977 19.5019 2.55693 19.7421C3.07424 20.014 2.7067 19.9993 9.02885 19.9999C14.5947 20.0005 14.7431 19.9986 15.0389 19.923C15.2057 19.8803 15.4414 19.7892 15.5627 19.7205C15.8538 19.5556 16.2215 19.178 16.3778 18.8834C16.6392 18.3909 16.6232 18.8649 16.6232 11.6035V5.0199L14.1135 2.50995L11.6038 0L7.44338 0.00324227C3.99501 0.00593765 3.24386 0.015977 3.05428 0.0618766ZM11.0845 2.82234C11.0992 4.30855 11.1024 4.3625 11.1889 4.58145C11.3562 5.00517 11.6634 5.31252 12.0725 5.46561C12.2791 5.54292 12.3656 5.54702 13.7878 5.54702H15.2855L15.3127 9.5022C15.3276 11.6776 15.3341 14.5047 15.3272 15.7847L15.3146 18.1122L15.197 18.3022C15.1135 18.4372 15.0233 18.5212 14.8856 18.5921L14.6917 18.6919L9.14358 18.7024C5.17637 18.7098 3.53566 18.7004 3.38542 18.6692C3.22952 18.6369 3.13128 18.5851 3.00459 18.4683C2.77099 18.253 2.71658 18.054 2.71658 17.4152V16.9145H7.91328C13.6857 16.9145 13.2555 16.9347 13.5481 16.6496C13.8144 16.3901 13.8106 16.4365 13.8106 13.4676C13.8106 11.5832 13.7975 10.764 13.7652 10.6359C13.706 10.4008 13.4251 10.1036 13.2051 10.0434C13.0957 10.0135 11.5017 10.0006 7.88273 10.0005L2.71658 10.0003V6.04242C2.71658 2.67433 2.72513 2.05576 2.774 1.89122C2.84982 1.63582 3.07639 1.41293 3.32921 1.34496C3.47675 1.30527 4.33236 1.29378 7.2933 1.29171L11.0692 1.2891L11.0845 2.82234ZM10.7385 11.786C10.9623 11.8475 10.9668 11.8514 10.9475 11.9695C10.9367 12.0359 10.8993 12.1884 10.8644 12.3084L10.8009 12.5267L10.5819 12.4527C10.3006 12.3577 9.88411 12.3511 9.7143 12.439C9.56457 12.5164 9.49133 12.6742 9.5477 12.798C9.60723 12.9286 9.81555 13.068 10.1488 13.2C10.5271 13.3499 10.7055 13.4616 10.8861 13.6616C11.0735 13.869 11.1294 14.0511 11.106 14.378C11.0719 14.8542 10.8037 15.1606 10.2822 15.3193C10.0556 15.3883 9.94693 15.3975 9.55949 15.3809C9.14483 15.3631 8.78232 15.2868 8.68123 15.196C8.65384 15.1715 8.77799 14.5902 8.81947 14.5487C8.82783 14.5403 8.9303 14.5701 9.04721 14.615C9.35199 14.7318 9.85938 14.7591 10.0585 14.6693C10.227 14.5933 10.3183 14.435 10.2806 14.2846C10.2449 14.1422 10.0799 14.0015 9.83458 13.9041C8.98987 13.5688 8.71447 13.2904 8.71619 12.7738C8.719 11.936 9.64242 11.4849 10.7385 11.786ZM3.6652 12.139C3.76372 12.3485 3.89442 12.632 3.95563 12.7692L4.06693 13.0184L4.2381 12.6129C4.33225 12.3899 4.45936 12.1063 4.52053 11.9827L4.63182 11.7581H5.08465C5.43106 11.7581 5.53302 11.7696 5.51845 11.8069C5.50794 11.8338 5.28579 12.224 5.02476 12.6741C4.7637 13.1241 4.55909 13.5157 4.57007 13.5443C4.58815 13.5914 5.3536 14.9221 5.53685 15.225L5.61365 15.352H5.14192H4.67022L4.34256 14.6976L4.01493 14.0433L3.95134 14.1996C3.91638 14.2855 3.78684 14.5799 3.66352 14.8537L3.43925 15.3516L2.98026 15.3518C2.72779 15.3519 2.52126 15.3451 2.52126 15.3367C2.52126 15.3283 2.74978 14.922 3.02909 14.434C3.30839 13.9459 3.53691 13.5392 3.53691 13.5302C3.53691 13.5212 3.31718 13.1253 3.04862 12.6504C2.78006 12.1755 2.56032 11.7805 2.56032 11.7726C2.56032 11.7646 2.76861 11.7581 3.02319 11.7581H3.48605L3.6652 12.139ZM6.86661 13.2132L6.87684 14.6684L7.58975 14.679L8.30266 14.6896V15.0208V15.352H7.16982H6.03698V13.555V11.7581H6.44668H6.85637L6.86661 13.2132Z" fill="#285FFA"/>
                                        </svg>
                                        Скачать XLS
                                    </a>
                                </div>
                            </legend>
                        </div>
                    </div>
                </div>
                <div class="main__line"></div>
                <div class="main__group">
                    <div class="main__element">
                        <div class="element__title">
                            Индексация
                            <span class="element__label">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M10 18.75C7.67936 18.75 5.45376 17.8281 3.81282 16.1872C2.17187 14.5462 1.25 12.3206 1.25 10C1.25 7.67936 2.17187 5.45376 3.81282 3.81282C5.45376 2.17187 7.67936 1.25 10 1.25C12.3206 1.25 14.5462 2.17187 16.1872 3.81282C17.8281 5.45376 18.75 7.67936 18.75 10C18.75 12.3206 17.8281 14.5462 16.1872 16.1872C14.5462 17.8281 12.3206 18.75 10 18.75ZM10 20C12.6522 20 15.1957 18.9464 17.0711 17.0711C18.9464 15.1957 20 12.6522 20 10C20 7.34784 18.9464 4.8043 17.0711 2.92893C15.1957 1.05357 12.6522 0 10 0C7.34784 0 4.8043 1.05357 2.92893 2.92893C1.05357 4.8043 0 7.34784 0 10C0 12.6522 1.05357 15.1957 2.92893 17.0711C4.8043 18.9464 7.34784 20 10 20V20Z" fill="#9B9B9B"/>
                                <path d="M7.27292 7.65832C7.27154 7.69267 7.27682 7.72694 7.28844 7.75905C7.30006 7.79115 7.31776 7.82041 7.34046 7.84501C7.36317 7.86961 7.39039 7.88904 7.42046 7.90211C7.45053 7.91518 7.48281 7.9216 7.51531 7.92099H8.34508C8.48387 7.92099 8.59451 7.80082 8.61261 7.65513C8.70313 6.95751 9.15573 6.44919 9.96237 6.44919C10.6523 6.44919 11.284 6.81395 11.284 7.69129C11.284 8.36658 10.9078 8.6771 10.3134 9.14927C9.6365 9.66929 9.10042 10.2765 9.13864 11.2623L9.14165 11.4931C9.14271 11.5629 9.16967 11.6294 9.21671 11.6783C9.26375 11.7273 9.3271 11.7547 9.3931 11.7547H10.2088C10.2755 11.7547 10.3394 11.7267 10.3866 11.6768C10.4337 11.627 10.4602 11.5594 10.4602 11.4888V11.3772C10.4602 10.6136 10.7348 10.3914 11.4761 9.7969C12.0886 9.30453 12.7272 8.75792 12.7272 7.61047C12.7272 6.00361 11.4439 5.22729 10.0388 5.22729C8.76449 5.22729 7.36847 5.85473 7.27292 7.65832V7.65832ZM8.83891 13.7869C8.83891 14.3538 9.26637 14.7727 9.85475 14.7727C10.4673 14.7727 10.8887 14.3538 10.8887 13.7869C10.8887 13.1999 10.4663 12.7873 9.85374 12.7873C9.26637 12.7873 8.83891 13.1999 8.83891 13.7869Z" fill="#9B9B9B"/>
                                </svg>
                                <div class="element__popup">
                                    Причины блокировки индексации с технической стороны
                                </div>
                            </span>
                        </div>
                        <div class="element__content circle">
                            <canvas class="content__canvas" id="index"></canvas>
                            <legend class="content__info circle" for="index" id="info">
                                <div class="info__element" style="padding: 7.5px 0px;">
                                    <span class="legend__head">Тип данных</span>
                                    <span style="margin-left: 5px;" class="legend__head">Проценты</span>
                                </div>
                            </legend>
                        </div>
                        <div class="element__btn">
                            <a class="download__btn download__xls">
                                <svg width="17" height="20" viewBox="0 0 17 20" fill="none" xmlns="http://startAnglew.w3.org/2000/svg">
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M3.05428 0.0618766C2.5724 0.17852 2.07457 0.524193 1.7932 0.937524C1.72737 1.03421 1.62253 1.23636 1.56026 1.38675L1.44701 1.6602L1.43623 5.83023L1.42545 10.0003H1.23814C0.975205 10.0003 0.66133 10.1658 0.509724 10.3845L0.392299 10.5538L0.3814 13.3924C0.369135 16.5841 0.357415 16.4434 0.656486 16.6994C0.832936 16.8504 1.01052 16.914 1.25717 16.9143L1.41893 16.9145L1.436 17.6274C1.4517 18.2818 1.46151 18.362 1.55588 18.6044C1.75085 19.1053 2.09977 19.5019 2.55693 19.7421C3.07424 20.014 2.7067 19.9993 9.02885 19.9999C14.5947 20.0005 14.7431 19.9986 15.0389 19.923C15.2057 19.8803 15.4414 19.7892 15.5627 19.7205C15.8538 19.5556 16.2215 19.178 16.3778 18.8834C16.6392 18.3909 16.6232 18.8649 16.6232 11.6035V5.0199L14.1135 2.50995L11.6038 0L7.44338 0.00324227C3.99501 0.00593765 3.24386 0.015977 3.05428 0.0618766ZM11.0845 2.82234C11.0992 4.30855 11.1024 4.3625 11.1889 4.58145C11.3562 5.00517 11.6634 5.31252 12.0725 5.46561C12.2791 5.54292 12.3656 5.54702 13.7878 5.54702H15.2855L15.3127 9.5022C15.3276 11.6776 15.3341 14.5047 15.3272 15.7847L15.3146 18.1122L15.197 18.3022C15.1135 18.4372 15.0233 18.5212 14.8856 18.5921L14.6917 18.6919L9.14358 18.7024C5.17637 18.7098 3.53566 18.7004 3.38542 18.6692C3.22952 18.6369 3.13128 18.5851 3.00459 18.4683C2.77099 18.253 2.71658 18.054 2.71658 17.4152V16.9145H7.91328C13.6857 16.9145 13.2555 16.9347 13.5481 16.6496C13.8144 16.3901 13.8106 16.4365 13.8106 13.4676C13.8106 11.5832 13.7975 10.764 13.7652 10.6359C13.706 10.4008 13.4251 10.1036 13.2051 10.0434C13.0957 10.0135 11.5017 10.0006 7.88273 10.0005L2.71658 10.0003V6.04242C2.71658 2.67433 2.72513 2.05576 2.774 1.89122C2.84982 1.63582 3.07639 1.41293 3.32921 1.34496C3.47675 1.30527 4.33236 1.29378 7.2933 1.29171L11.0692 1.2891L11.0845 2.82234ZM10.7385 11.786C10.9623 11.8475 10.9668 11.8514 10.9475 11.9695C10.9367 12.0359 10.8993 12.1884 10.8644 12.3084L10.8009 12.5267L10.5819 12.4527C10.3006 12.3577 9.88411 12.3511 9.7143 12.439C9.56457 12.5164 9.49133 12.6742 9.5477 12.798C9.60723 12.9286 9.81555 13.068 10.1488 13.2C10.5271 13.3499 10.7055 13.4616 10.8861 13.6616C11.0735 13.869 11.1294 14.0511 11.106 14.378C11.0719 14.8542 10.8037 15.1606 10.2822 15.3193C10.0556 15.3883 9.94693 15.3975 9.55949 15.3809C9.14483 15.3631 8.78232 15.2868 8.68123 15.196C8.65384 15.1715 8.77799 14.5902 8.81947 14.5487C8.82783 14.5403 8.9303 14.5701 9.04721 14.615C9.35199 14.7318 9.85938 14.7591 10.0585 14.6693C10.227 14.5933 10.3183 14.435 10.2806 14.2846C10.2449 14.1422 10.0799 14.0015 9.83458 13.9041C8.98987 13.5688 8.71447 13.2904 8.71619 12.7738C8.719 11.936 9.64242 11.4849 10.7385 11.786ZM3.6652 12.139C3.76372 12.3485 3.89442 12.632 3.95563 12.7692L4.06693 13.0184L4.2381 12.6129C4.33225 12.3899 4.45936 12.1063 4.52053 11.9827L4.63182 11.7581H5.08465C5.43106 11.7581 5.53302 11.7696 5.51845 11.8069C5.50794 11.8338 5.28579 12.224 5.02476 12.6741C4.7637 13.1241 4.55909 13.5157 4.57007 13.5443C4.58815 13.5914 5.3536 14.9221 5.53685 15.225L5.61365 15.352H5.14192H4.67022L4.34256 14.6976L4.01493 14.0433L3.95134 14.1996C3.91638 14.2855 3.78684 14.5799 3.66352 14.8537L3.43925 15.3516L2.98026 15.3518C2.72779 15.3519 2.52126 15.3451 2.52126 15.3367C2.52126 15.3283 2.74978 14.922 3.02909 14.434C3.30839 13.9459 3.53691 13.5392 3.53691 13.5302C3.53691 13.5212 3.31718 13.1253 3.04862 12.6504C2.78006 12.1755 2.56032 11.7805 2.56032 11.7726C2.56032 11.7646 2.76861 11.7581 3.02319 11.7581H3.48605L3.6652 12.139ZM6.86661 13.2132L6.87684 14.6684L7.58975 14.679L8.30266 14.6896V15.0208V15.352H7.16982H6.03698V13.555V11.7581H6.44668H6.85637L6.86661 13.2132Z" fill="#285FFA"/>
                                </svg>
                                Скачать XLS
                            </a>
                        </div>
                    </div>
                    <div class="main__element">
                        <div class="element__title">
                            Изображения
                            <span class="element__label">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M10 18.75C7.67936 18.75 5.45376 17.8281 3.81282 16.1872C2.17187 14.5462 1.25 12.3206 1.25 10C1.25 7.67936 2.17187 5.45376 3.81282 3.81282C5.45376 2.17187 7.67936 1.25 10 1.25C12.3206 1.25 14.5462 2.17187 16.1872 3.81282C17.8281 5.45376 18.75 7.67936 18.75 10C18.75 12.3206 17.8281 14.5462 16.1872 16.1872C14.5462 17.8281 12.3206 18.75 10 18.75ZM10 20C12.6522 20 15.1957 18.9464 17.0711 17.0711C18.9464 15.1957 20 12.6522 20 10C20 7.34784 18.9464 4.8043 17.0711 2.92893C15.1957 1.05357 12.6522 0 10 0C7.34784 0 4.8043 1.05357 2.92893 2.92893C1.05357 4.8043 0 7.34784 0 10C0 12.6522 1.05357 15.1957 2.92893 17.0711C4.8043 18.9464 7.34784 20 10 20V20Z" fill="#9B9B9B"/>
                                <path d="M7.27292 7.65832C7.27154 7.69267 7.27682 7.72694 7.28844 7.75905C7.30006 7.79115 7.31776 7.82041 7.34046 7.84501C7.36317 7.86961 7.39039 7.88904 7.42046 7.90211C7.45053 7.91518 7.48281 7.9216 7.51531 7.92099H8.34508C8.48387 7.92099 8.59451 7.80082 8.61261 7.65513C8.70313 6.95751 9.15573 6.44919 9.96237 6.44919C10.6523 6.44919 11.284 6.81395 11.284 7.69129C11.284 8.36658 10.9078 8.6771 10.3134 9.14927C9.6365 9.66929 9.10042 10.2765 9.13864 11.2623L9.14165 11.4931C9.14271 11.5629 9.16967 11.6294 9.21671 11.6783C9.26375 11.7273 9.3271 11.7547 9.3931 11.7547H10.2088C10.2755 11.7547 10.3394 11.7267 10.3866 11.6768C10.4337 11.627 10.4602 11.5594 10.4602 11.4888V11.3772C10.4602 10.6136 10.7348 10.3914 11.4761 9.7969C12.0886 9.30453 12.7272 8.75792 12.7272 7.61047C12.7272 6.00361 11.4439 5.22729 10.0388 5.22729C8.76449 5.22729 7.36847 5.85473 7.27292 7.65832V7.65832ZM8.83891 13.7869C8.83891 14.3538 9.26637 14.7727 9.85475 14.7727C10.4673 14.7727 10.8887 14.3538 10.8887 13.7869C10.8887 13.1999 10.4663 12.7873 9.85374 12.7873C9.26637 12.7873 8.83891 13.1999 8.83891 13.7869Z" fill="#9B9B9B"/>
                                </svg>
                                <div class="element__popup">
                                    Проверка оптимизации изображений
                                </div>
                            </span>
                        </div>
                        <div class="element__content circle">
                            <canvas class="content__canvas" id="images"></canvas>
                            <legend class="content__info circle" for="images" id="info">
                                <div class="info__element" style="padding: 7.5px 0px;">
                                    <span class="legend__head">Тип данных</span>
                                    <span style="margin-left: 5px;" class="legend__head">Проценты</span>
                                </div>
                            </legend>
                        </div>
                        <div class="element__btn">
                            <a class="download__btn download__xls">
                                <svg width="17" height="20" viewBox="0 0 17 20" fill="none" xmlns="http://startAnglew.w3.org/2000/svg">
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M3.05428 0.0618766C2.5724 0.17852 2.07457 0.524193 1.7932 0.937524C1.72737 1.03421 1.62253 1.23636 1.56026 1.38675L1.44701 1.6602L1.43623 5.83023L1.42545 10.0003H1.23814C0.975205 10.0003 0.66133 10.1658 0.509724 10.3845L0.392299 10.5538L0.3814 13.3924C0.369135 16.5841 0.357415 16.4434 0.656486 16.6994C0.832936 16.8504 1.01052 16.914 1.25717 16.9143L1.41893 16.9145L1.436 17.6274C1.4517 18.2818 1.46151 18.362 1.55588 18.6044C1.75085 19.1053 2.09977 19.5019 2.55693 19.7421C3.07424 20.014 2.7067 19.9993 9.02885 19.9999C14.5947 20.0005 14.7431 19.9986 15.0389 19.923C15.2057 19.8803 15.4414 19.7892 15.5627 19.7205C15.8538 19.5556 16.2215 19.178 16.3778 18.8834C16.6392 18.3909 16.6232 18.8649 16.6232 11.6035V5.0199L14.1135 2.50995L11.6038 0L7.44338 0.00324227C3.99501 0.00593765 3.24386 0.015977 3.05428 0.0618766ZM11.0845 2.82234C11.0992 4.30855 11.1024 4.3625 11.1889 4.58145C11.3562 5.00517 11.6634 5.31252 12.0725 5.46561C12.2791 5.54292 12.3656 5.54702 13.7878 5.54702H15.2855L15.3127 9.5022C15.3276 11.6776 15.3341 14.5047 15.3272 15.7847L15.3146 18.1122L15.197 18.3022C15.1135 18.4372 15.0233 18.5212 14.8856 18.5921L14.6917 18.6919L9.14358 18.7024C5.17637 18.7098 3.53566 18.7004 3.38542 18.6692C3.22952 18.6369 3.13128 18.5851 3.00459 18.4683C2.77099 18.253 2.71658 18.054 2.71658 17.4152V16.9145H7.91328C13.6857 16.9145 13.2555 16.9347 13.5481 16.6496C13.8144 16.3901 13.8106 16.4365 13.8106 13.4676C13.8106 11.5832 13.7975 10.764 13.7652 10.6359C13.706 10.4008 13.4251 10.1036 13.2051 10.0434C13.0957 10.0135 11.5017 10.0006 7.88273 10.0005L2.71658 10.0003V6.04242C2.71658 2.67433 2.72513 2.05576 2.774 1.89122C2.84982 1.63582 3.07639 1.41293 3.32921 1.34496C3.47675 1.30527 4.33236 1.29378 7.2933 1.29171L11.0692 1.2891L11.0845 2.82234ZM10.7385 11.786C10.9623 11.8475 10.9668 11.8514 10.9475 11.9695C10.9367 12.0359 10.8993 12.1884 10.8644 12.3084L10.8009 12.5267L10.5819 12.4527C10.3006 12.3577 9.88411 12.3511 9.7143 12.439C9.56457 12.5164 9.49133 12.6742 9.5477 12.798C9.60723 12.9286 9.81555 13.068 10.1488 13.2C10.5271 13.3499 10.7055 13.4616 10.8861 13.6616C11.0735 13.869 11.1294 14.0511 11.106 14.378C11.0719 14.8542 10.8037 15.1606 10.2822 15.3193C10.0556 15.3883 9.94693 15.3975 9.55949 15.3809C9.14483 15.3631 8.78232 15.2868 8.68123 15.196C8.65384 15.1715 8.77799 14.5902 8.81947 14.5487C8.82783 14.5403 8.9303 14.5701 9.04721 14.615C9.35199 14.7318 9.85938 14.7591 10.0585 14.6693C10.227 14.5933 10.3183 14.435 10.2806 14.2846C10.2449 14.1422 10.0799 14.0015 9.83458 13.9041C8.98987 13.5688 8.71447 13.2904 8.71619 12.7738C8.719 11.936 9.64242 11.4849 10.7385 11.786ZM3.6652 12.139C3.76372 12.3485 3.89442 12.632 3.95563 12.7692L4.06693 13.0184L4.2381 12.6129C4.33225 12.3899 4.45936 12.1063 4.52053 11.9827L4.63182 11.7581H5.08465C5.43106 11.7581 5.53302 11.7696 5.51845 11.8069C5.50794 11.8338 5.28579 12.224 5.02476 12.6741C4.7637 13.1241 4.55909 13.5157 4.57007 13.5443C4.58815 13.5914 5.3536 14.9221 5.53685 15.225L5.61365 15.352H5.14192H4.67022L4.34256 14.6976L4.01493 14.0433L3.95134 14.1996C3.91638 14.2855 3.78684 14.5799 3.66352 14.8537L3.43925 15.3516L2.98026 15.3518C2.72779 15.3519 2.52126 15.3451 2.52126 15.3367C2.52126 15.3283 2.74978 14.922 3.02909 14.434C3.30839 13.9459 3.53691 13.5392 3.53691 13.5302C3.53691 13.5212 3.31718 13.1253 3.04862 12.6504C2.78006 12.1755 2.56032 11.7805 2.56032 11.7726C2.56032 11.7646 2.76861 11.7581 3.02319 11.7581H3.48605L3.6652 12.139ZM6.86661 13.2132L6.87684 14.6684L7.58975 14.679L8.30266 14.6896V15.0208V15.352H7.16982H6.03698V13.555V11.7581H6.44668H6.85637L6.86661 13.2132Z" fill="#285FFA"/>
                                </svg>
                                Скачать XLS
                            </a>
                        </div>
                    </div>
                    <div class="main__element commerce">
                        <div class="element__title">
                            Коммерция
                            <span class="element__label">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M10 18.75C7.67936 18.75 5.45376 17.8281 3.81282 16.1872C2.17187 14.5462 1.25 12.3206 1.25 10C1.25 7.67936 2.17187 5.45376 3.81282 3.81282C5.45376 2.17187 7.67936 1.25 10 1.25C12.3206 1.25 14.5462 2.17187 16.1872 3.81282C17.8281 5.45376 18.75 7.67936 18.75 10C18.75 12.3206 17.8281 14.5462 16.1872 16.1872C14.5462 17.8281 12.3206 18.75 10 18.75ZM10 20C12.6522 20 15.1957 18.9464 17.0711 17.0711C18.9464 15.1957 20 12.6522 20 10C20 7.34784 18.9464 4.8043 17.0711 2.92893C15.1957 1.05357 12.6522 0 10 0C7.34784 0 4.8043 1.05357 2.92893 2.92893C1.05357 4.8043 0 7.34784 0 10C0 12.6522 1.05357 15.1957 2.92893 17.0711C4.8043 18.9464 7.34784 20 10 20V20Z" fill="#9B9B9B"/>
                                <path d="M7.27292 7.65832C7.27154 7.69267 7.27682 7.72694 7.28844 7.75905C7.30006 7.79115 7.31776 7.82041 7.34046 7.84501C7.36317 7.86961 7.39039 7.88904 7.42046 7.90211C7.45053 7.91518 7.48281 7.9216 7.51531 7.92099H8.34508C8.48387 7.92099 8.59451 7.80082 8.61261 7.65513C8.70313 6.95751 9.15573 6.44919 9.96237 6.44919C10.6523 6.44919 11.284 6.81395 11.284 7.69129C11.284 8.36658 10.9078 8.6771 10.3134 9.14927C9.6365 9.66929 9.10042 10.2765 9.13864 11.2623L9.14165 11.4931C9.14271 11.5629 9.16967 11.6294 9.21671 11.6783C9.26375 11.7273 9.3271 11.7547 9.3931 11.7547H10.2088C10.2755 11.7547 10.3394 11.7267 10.3866 11.6768C10.4337 11.627 10.4602 11.5594 10.4602 11.4888V11.3772C10.4602 10.6136 10.7348 10.3914 11.4761 9.7969C12.0886 9.30453 12.7272 8.75792 12.7272 7.61047C12.7272 6.00361 11.4439 5.22729 10.0388 5.22729C8.76449 5.22729 7.36847 5.85473 7.27292 7.65832V7.65832ZM8.83891 13.7869C8.83891 14.3538 9.26637 14.7727 9.85475 14.7727C10.4673 14.7727 10.8887 14.3538 10.8887 13.7869C10.8887 13.1999 10.4663 12.7873 9.85374 12.7873C9.26637 12.7873 8.83891 13.1999 8.83891 13.7869Z" fill="#9B9B9B"/>
                                </svg>
                                <div class="element__popup">
                                    Оптимизация сайта по коммерческим факторам
                                </div>
                            </span>
                        </div>
                        <div class="element__content circle commerce">
                            <canvas class="content__canvas" id="commerce"></canvas>
                            <div class="element__btn">
                                <a class="download__btn download__xls">
                                    <svg width="17" height="20" viewBox="0 0 17 20" fill="none" xmlns="http://startAnglew.w3.org/2000/svg">
                                        <path fill-rule="evenodd" clip-rule="evenodd" d="M3.05428 0.0618766C2.5724 0.17852 2.07457 0.524193 1.7932 0.937524C1.72737 1.03421 1.62253 1.23636 1.56026 1.38675L1.44701 1.6602L1.43623 5.83023L1.42545 10.0003H1.23814C0.975205 10.0003 0.66133 10.1658 0.509724 10.3845L0.392299 10.5538L0.3814 13.3924C0.369135 16.5841 0.357415 16.4434 0.656486 16.6994C0.832936 16.8504 1.01052 16.914 1.25717 16.9143L1.41893 16.9145L1.436 17.6274C1.4517 18.2818 1.46151 18.362 1.55588 18.6044C1.75085 19.1053 2.09977 19.5019 2.55693 19.7421C3.07424 20.014 2.7067 19.9993 9.02885 19.9999C14.5947 20.0005 14.7431 19.9986 15.0389 19.923C15.2057 19.8803 15.4414 19.7892 15.5627 19.7205C15.8538 19.5556 16.2215 19.178 16.3778 18.8834C16.6392 18.3909 16.6232 18.8649 16.6232 11.6035V5.0199L14.1135 2.50995L11.6038 0L7.44338 0.00324227C3.99501 0.00593765 3.24386 0.015977 3.05428 0.0618766ZM11.0845 2.82234C11.0992 4.30855 11.1024 4.3625 11.1889 4.58145C11.3562 5.00517 11.6634 5.31252 12.0725 5.46561C12.2791 5.54292 12.3656 5.54702 13.7878 5.54702H15.2855L15.3127 9.5022C15.3276 11.6776 15.3341 14.5047 15.3272 15.7847L15.3146 18.1122L15.197 18.3022C15.1135 18.4372 15.0233 18.5212 14.8856 18.5921L14.6917 18.6919L9.14358 18.7024C5.17637 18.7098 3.53566 18.7004 3.38542 18.6692C3.22952 18.6369 3.13128 18.5851 3.00459 18.4683C2.77099 18.253 2.71658 18.054 2.71658 17.4152V16.9145H7.91328C13.6857 16.9145 13.2555 16.9347 13.5481 16.6496C13.8144 16.3901 13.8106 16.4365 13.8106 13.4676C13.8106 11.5832 13.7975 10.764 13.7652 10.6359C13.706 10.4008 13.4251 10.1036 13.2051 10.0434C13.0957 10.0135 11.5017 10.0006 7.88273 10.0005L2.71658 10.0003V6.04242C2.71658 2.67433 2.72513 2.05576 2.774 1.89122C2.84982 1.63582 3.07639 1.41293 3.32921 1.34496C3.47675 1.30527 4.33236 1.29378 7.2933 1.29171L11.0692 1.2891L11.0845 2.82234ZM10.7385 11.786C10.9623 11.8475 10.9668 11.8514 10.9475 11.9695C10.9367 12.0359 10.8993 12.1884 10.8644 12.3084L10.8009 12.5267L10.5819 12.4527C10.3006 12.3577 9.88411 12.3511 9.7143 12.439C9.56457 12.5164 9.49133 12.6742 9.5477 12.798C9.60723 12.9286 9.81555 13.068 10.1488 13.2C10.5271 13.3499 10.7055 13.4616 10.8861 13.6616C11.0735 13.869 11.1294 14.0511 11.106 14.378C11.0719 14.8542 10.8037 15.1606 10.2822 15.3193C10.0556 15.3883 9.94693 15.3975 9.55949 15.3809C9.14483 15.3631 8.78232 15.2868 8.68123 15.196C8.65384 15.1715 8.77799 14.5902 8.81947 14.5487C8.82783 14.5403 8.9303 14.5701 9.04721 14.615C9.35199 14.7318 9.85938 14.7591 10.0585 14.6693C10.227 14.5933 10.3183 14.435 10.2806 14.2846C10.2449 14.1422 10.0799 14.0015 9.83458 13.9041C8.98987 13.5688 8.71447 13.2904 8.71619 12.7738C8.719 11.936 9.64242 11.4849 10.7385 11.786ZM3.6652 12.139C3.76372 12.3485 3.89442 12.632 3.95563 12.7692L4.06693 13.0184L4.2381 12.6129C4.33225 12.3899 4.45936 12.1063 4.52053 11.9827L4.63182 11.7581H5.08465C5.43106 11.7581 5.53302 11.7696 5.51845 11.8069C5.50794 11.8338 5.28579 12.224 5.02476 12.6741C4.7637 13.1241 4.55909 13.5157 4.57007 13.5443C4.58815 13.5914 5.3536 14.9221 5.53685 15.225L5.61365 15.352H5.14192H4.67022L4.34256 14.6976L4.01493 14.0433L3.95134 14.1996C3.91638 14.2855 3.78684 14.5799 3.66352 14.8537L3.43925 15.3516L2.98026 15.3518C2.72779 15.3519 2.52126 15.3451 2.52126 15.3367C2.52126 15.3283 2.74978 14.922 3.02909 14.434C3.30839 13.9459 3.53691 13.5392 3.53691 13.5302C3.53691 13.5212 3.31718 13.1253 3.04862 12.6504C2.78006 12.1755 2.56032 11.7805 2.56032 11.7726C2.56032 11.7646 2.76861 11.7581 3.02319 11.7581H3.48605L3.6652 12.139ZM6.86661 13.2132L6.87684 14.6684L7.58975 14.679L8.30266 14.6896V15.0208V15.352H7.16982H6.03698V13.555V11.7581H6.44668H6.85637L6.86661 13.2132Z" fill="#285FFA"/>
                                    </svg>
                                    Скачать XLS
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        <?endif;?>
    </div>
    <script lang="javascript" src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <script lang="javascript" src="https://html2canvas.hertzen.com/dist/html2canvas.js"></script>
    <link rel="stylesheet" href="/bitrix/themes/.default/umax.seoanalysis/fonts.css">
    <?if($isEmpty == false):?>
        <script>
            document.querySelector('#allXLS').addEventListener('click', function() {
                const workbook = XLSX.utils.book_new();
                for (let i = 0; i < 6; i++) {
                    switch (i) {
                        case 0:
                            data = <?=$data['SEO OnPage']?>;
                            name = 'SEO OnPage';
                            break;
                        case 1:
                            data = <?=$data['Страницы']?>;
                            name = 'Страницы';
                            break;
                        case 2:
                            data = <?=$data['Мета теги']?>;
                            name = 'Мета теги';
                            break;
                        case 3:
                            data = <?=$data['Индексация']?>;
                            name = 'Индексация';
                            break;
                        case 4:
                            data = <?=$data['Изображения']?>;
                            name = 'Изображения';
                            break;
                        case 5:
                            data = <?=$data['Коммерция']?>;
                            name = 'Коммерция';
                            break;
                        default:
                            break;
                    }
                    if(data) {
                        for (let j = 0; j < data.length; j++) {
                            for (let k in data[j]) {
                                if(typeof data[j][k] == 'object' && data[j][k]) {
                                    data[j][k] = Object.values(data[j][k])
                                    data[j][k] = data[j][k].join(', ')
                                }
                            }
                        }
                        const worksheet = XLSX.utils.json_to_sheet(data);
                        XLSX.utils.book_append_sheet(workbook, worksheet, name);  
                    }
                }
                XLSX.writeFile(workbook, "Анализ.xlsx");
            })

            function drawLine(ctx, startX, startY, endX, endY,color){
                ctx.save();
                ctx.strokeStyle = color;
                ctx.beginPath();
                ctx.moveTo(startX,startY);
                ctx.lineTo(endX,endY);
                ctx.stroke();
                ctx.restore();
            }
            
            function drawBar(ctx, upperLeftCornerX, upperLeftCornerY, width, height, color, radiusAr = false){
                ctx.save();
                ctx.fillStyle=color;
                if(radiusAr) {
                    ctx.beginPath();
                    ctx.moveTo(upperLeftCornerX, upperLeftCornerY);
                    ctx.arcTo(upperLeftCornerX + width, upperLeftCornerY, upperLeftCornerX + width, upperLeftCornerY + height, radiusAr.tr);
                    ctx.arcTo(upperLeftCornerX + width, upperLeftCornerY + height, upperLeftCornerX, upperLeftCornerY + height, radiusAr.br);
                    ctx.arcTo(upperLeftCornerX, upperLeftCornerY + height, upperLeftCornerX, upperLeftCornerY, radiusAr.bl);
                    ctx.arcTo(upperLeftCornerX, upperLeftCornerY, upperLeftCornerX + width, upperLeftCornerY, radiusAr.tl);
                    ctx.fill()
                } else {
                    ctx.fillRect(upperLeftCornerX,upperLeftCornerY,width,height);
                }
                ctx.restore();
            }

            function drawArc(ctx, centerX, centerY, radius = false, startAngle, endAngle, color){
                ctx.save();
                ctx.strokeStyle = color;
                ctx.beginPath();
                ctx.arc(centerX, centerY, radius, startAngle, endAngle);
                ctx.restore();
            }
            
            function drawPieSlice(ctx,centerX, centerY, radius, startAngle, endAngle, fillColor, strokeColor) {
                ctx.save();
                ctx.fillStyle = fillColor;
                ctx.strokeStyle = strokeColor;
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, startAngle, endAngle, strokeColor);
                ctx.closePath();
                ctx.fill();
                ctx.restore();
            }

            function sum( obj ) {
                var sum = 0;
                for( var el in obj ) {
                    if( obj.hasOwnProperty( el ) ) {
                    sum += parseFloat( obj[el] );
                    }
                }
                return sum;
            }
            
            var Barchart = function(options){
                this.options = options;
                this.canvas = options.canvas;
                this.ctx = this.canvas.getContext("2d");
                this.colors = options.colors;
            
                this.draw = function(){
                    var maxValue = 0;
                    for (var categ in this.options.data){
                        maxValue = Math.max(maxValue,this.options.data[categ]);
                    }
                    var canvasActualHeight = this.canvas.height - this.options.padding * 2;
                    var canvasActualWidth = this.canvas.width - this.options.padding * 2;
            
                    //drawing the bars
                    var barIndex = 0;
                    var categIndex = 0;
            
                    if(this.options.horizontal) {
                        let i = 0
                        for (categ in this.options.data){ 
                
                            this.ctx.font = "bold 16px Mont";
                            this.ctx.fillStyle = '#000';
                            this.ctx.fillText(categ, 0, 60 + i * 45); 
                            i++
                        }
                        for(let i = 0; i < 6; i++) { 
                            this.ctx.strokeStyle = 'rgba(0, 0, 0, 0.5)';
                            this.ctx.lineWidth = '1.5';
                            this.ctx.fillStyle = "#000000";
                            this.ctx.fillText(i * 20 + "%", i * 95 + 90 + i * 17.5, 190); 
                            this.ctx.beginPath(); 

                            if(i !== 0 && i !== 5) {
                                this.ctx.moveTo(i * 95 + 120 + i * 17.5 + 25 / 2, 160); 
                                this.ctx.lineTo(i * 95 + 120 + i * 17.5 + 25 / 2, 30); 
                            } else if (i == 0) {
                                this.ctx.moveTo(i * 95 + 120 + i * 17.5 + 6, 160); 
                                this.ctx.lineTo(i * 95 + 120 + i * 17.5 + 6, 30); 
                            } else {
                                this.ctx.moveTo(i * 95 + 120 + i * 17.5 + i * 4.5, 160); 
                                this.ctx.lineTo(i * 95 + 120 + i * 17.5 + i * 4.5, 30); 
                            }
                            
                            this.ctx.stroke(); 
                        }
                    } else {
                        for(let i = 0; i < 6; i++) { 
                            this.ctx.fillStyle = "#D6D8E2";
                            this.ctx.strokeStyle = '#D6D8E2';
                            if(i == 5) {
                                this.ctx.strokeStyle = '#000';
                            }
                            this.ctx.fillText((5 - i) * 20 + "%", 0, 30 + i * 45); 
                            this.ctx.beginPath(); 
                            this.ctx.moveTo(30, 30 + i * 45); 
                            this.ctx.lineTo(575, 30 + i * 45); 
                            this.ctx.stroke(); 
                        }
                    }

                    if(this.options.horizontal) {
                        for (categ in this.options.data){
                            maxValue = sum(this.options.data[categ]);
                            var numberOfBars = Object.keys(this.options.data[categ]).length;
                            var barSize = (canvasActualWidth)/numberOfBars - 40;
                            var lastElem = 30;
                            for (ctg in this.options.data[categ]){
                                var val = this.options.data[categ][ctg];
                                var barHeight = Math.round((canvasActualWidth - 60) * val/maxValue);
                                drawBar(
                                    this.ctx,
                                    lastElem + 65,
                                    40 + categIndex * 45,
                                    barHeight,
                                    30,
                                    this.colors[barIndex%this.colors.length]
                                );
                                let fillTextCtg = Math.round((this.options.data[categ][ctg] * 100) / maxValue)
                                this.ctx.font = "bold 12px Mont";
                                this.ctx.fillStyle = '#fff';
                                if(fillTextCtg > 0)
                                    this.ctx.fillText(fillTextCtg.toString() + '%', (barHeight / 2) + lastElem + 55, 57.5 + categIndex * 45);
                                lastElem += barHeight
                                
                                barIndex++;
                            }
                            categIndex++;
                        }
                    } else {
                        if(this.options.maxValue)
                            maxValue = this.options.maxValue;

                        var numberOfBars = Object.keys(this.options.data).length;
                        var barSize = (canvasActualWidth)/numberOfBars - 40;
                        for (categ in this.options.data){
                            var val = this.options.data[categ];
                            var barHeight = Math.round((canvasActualHeight - 16) * val/maxValue);
                            if(this.options.radiusAr) {
                                drawBar(
                                    this.ctx,
                                    this.options.padding + barIndex * barSize + (barIndex * 50),
                                    this.canvas.height - barHeight - this.options.padding - 16,
                                    barSize,
                                    barHeight,
                                    this.colors[barIndex%this.colors.length],
                                    this.options.radiusAr
                                );
                            } else {
                                drawBar(
                                    this.ctx,
                                    this.options.padding + barIndex * barSize + (barIndex * 50),
                                    this.canvas.height - barHeight - this.options.padding - 16,
                                    barSize,
                                    barHeight,
                                    this.colors[barIndex%this.colors.length]
                                );
                            }
                            this.ctx.fillStyle = '#000';
                            this.ctx.textAlign = 'center';
                            this.ctx.fillText(categ, this.options.padding + barIndex * barSize + (barIndex * 50) + (categ.length * 4) - 5, 285);
                            barIndex++;
                        }
                    }
                    
                    //draw legend
                    barIndex = 0;
                    let legend = document.querySelector("legend[for=\""+this.options.id+"\"]#info");
                    if(this.options.horizontal) {
                        var labels
                        var summs = {}
                        for (categ in this.options.data){
                            labels = Object.keys(this.options.data[categ])
                        }
                        for (let i = 0; i < labels.length; i++) {
                            let objTitle = labels[i]
                            summs[objTitle] = 0;
                        }
                        for (categ in this.options.data){
                            for(ctg in this.options.data[categ]) {
                                summs[ctg] += this.options.data[categ][ctg]
                            }
                        }
                        for (categ in summs){
                            let before = legend.querySelector('.element__btn')

                            var li = document.createElement("div");
                            li.classList.add('info__element')
                            li.style.padding = "7.5px 0";

                            var span = document.createElement("span");
                            span.classList.add('info__element')

                            var circle = document.createElement("div");
                            circle.classList.add('circle')
                            circle.style.background = this.colors[barIndex % this.colors.length]

                            var text = document.createElement("span");
                            var textContent = document.createElement("span");
                            text.classList.add('info__element')
                            textContent.textContent = categ;

                            var spanContent = document.createElement("span");
                            spanContent.style.fontWeight = 900;
                            spanContent.textContent = summs[categ]

                            var textBlock = document.createElement("div");
                            textBlock.classList.add('element__text')

                            text.append(circle)
                            text.append(textContent)

                            circle = document.createElement("div");
                            circle.classList.add('circle')

                            span.append(circle)
                            span.append(spanContent)

                            li.append(text)
                            li.append(span)

                            legend.insertBefore(li, before)
                            barIndex++;
                        }
                    } else {
                        for (categ in this.options.data){
                            var li = document.createElement("div");
                            var span = document.createElement("span");
                            // span.style.fontWeight = 900;
                            span.textContent = categ

                            let circle2 = document.createElement("div");
                            circle2.classList.add('circle')
                            circle2.style.background = this.colors[barIndex % this.colors.length]
                            
                            li.classList.add('info__element')
                            li.style.padding = "7.5px 0";
                            let newSpan = document.createElement('span')

                            var secondText = document.createElement("span");
                            secondText.classList.add('result')
                            secondText.textContent = this.options.data[categ];

                            newSpan.append(circle2)
                            newSpan.append(span)
                            li.append(newSpan)
                            li.append(secondText)
                            legend.append(li);
                            
                            legend.append(li);
                            barIndex++;
                        }
                        legend = document.querySelector("legend[for=\""+this.options.id+"\"]#title");
                        li = document.createElement("div");
                        li.classList.add('content__title')
                        li.textContent = '% оптимизации страниц'
                        legend.append(li);
                    }
                }
            }

            var PieChart = function(options){
                this.options = options;
                this.canvas = options.canvas;
                this.ctx = this.canvas.getContext("2d");
                this.colors = options.colors;
                this.titleOptions = options.titleOptions;
                this.totalValue = [...Object.values(this.options.data)].reduce((a, b) => a + b, 0);

                this.radius = Math.min(this.canvas.width / 2, this.canvas.height / 2) - options.padding;

                this.drawSlices = function() {
                    var colorIndex = 0;
                    var startAngle = -Math.PI / 2;

                    for (var categ in this.options.data) {
                        var val = this.options.data[categ];
                        var sliceAngle = (2 * Math.PI * (val)) / this.totalValue;
                        drawPieSlice(
                            this.ctx,
                            this.canvas.width / 2,
                            this.canvas.height / 2,
                            this.radius,
                            startAngle,
                            startAngle + sliceAngle,
                            this.colors[colorIndex % this.colors.length]
                        );

                        startAngle += sliceAngle;
                        colorIndex++;
                    }

                    if (this.options.doughnutHoleSize) {
                        drawPieSlice(
                            this.ctx,
                            this.canvas.width / 2,
                            this.canvas.height / 2,
                            this.options.doughnutHoleSize * this.radius,
                            0,
                            2 * Math.PI,
                            "#FFF",
                            "#FFF"
                        );

                        drawArc(
                            this.ctx,
                            this.canvas.width / 2,
                            this.canvas.height / 2,
                            this.options.doughnutHoleSize * this.radius,
                            0,
                            2 * Math.PI,
                            "#000"
                        );
                    }
                }

                this.drawLabels = function() {
                    var colorIndex = 0;
                    var startAngle = -Math.PI / 2;
                    for (var categ in this.options.data) {
                        var val = this.options.data[categ];
                        var sliceAngle = (2 * Math.PI * val) / this.totalValue;

                        if (this.options.doughnutHoleSize && !this.options.holeText) {
                            var offset = (this.radius * this.options.doughnutHoleSize) / 2;
                            labelX = this.canvas.width / 2;
                            labelY = this.canvas.height / 2;
                        } else {
                            var labelX =
                                this.canvas.width / 2 - 5 +
                                (this.radius / 2) * Math.cos(startAngle + sliceAngle / 2);
                            var labelY =
                                this.canvas.height / 2 + 10 +
                                (this.radius / 2) * Math.sin(startAngle + sliceAngle / 2);
                        }

                        var labelText = (100 * val) / this.totalValue;
                        this.ctx.fillStyle = "#fff";
                        this.ctx.font = "bold 20px Mont";
                        if(labelText >= 3 && (!this.options.doughnutHoleSize && !this.options.holeText))
                            this.ctx.fillText(Math.round(labelText), labelX, labelY);
                        startAngle += sliceAngle;
                    }
                }

                this.drawTitle = function() {
                    let labelY = this.radius;
                    let labelX = this.canvas.width / 2;
                    this.ctx.textAlign = 'center';
                    this.ctx.font = '800 24px Mont'
                    this.ctx.fillStyle = '#000'
                    this.ctx.fillText(this.options.seriesName[0], labelX, labelY + 20, this.canvas.width, this.canvas.height);
                    this.ctx.font = '700 14px Mont'
                    this.ctx.fillStyle = '#8B8B8B'
                    this.ctx.fillText(this.options.seriesName[1], labelX, labelY + 20 + 20, this.canvas.width, this.canvas.height);
                }

                this.drawLegend = function() {
                    let pIndex = 0;
                    let legend = document.querySelector("legend[for=\""+this.options.id+"\"]#info");
                    if (this.options.doughnutHoleSize && !this.options.holeText) {
                        let ctg = this.options.data.main + '%'
                        this.ctx.fillStyle = "#000";
                        this.ctx.font = "bold 20px Mont";
                        this.ctx.fillText(ctg, this.canvas.width / 2 - 15, this.canvas.height / 2);
                    } else if(!this.options.doughnutHoleSize) {
                        var summs = 0;
                        for(ctg in this.options.data) {
                            summs += this.options.data[ctg]
                        }
                        for (let ctg of Object.keys(this.options.data)) {
                            if(ctg !== 'maxValue') {
                                let persentage = (this.options.data[ctg] * 100) / summs
                                if(persentage > 0 && persentage < 1)
                                    persentage = ((this.options.data[ctg] * 100) / summs).toFixed(2)
                                else if (this.options.data[ctg] == 0)
                                    persentage = '0'
                                else
                                    persentage = Math.round(persentage)
                                persentage = persentage.toString();
                                var li = document.createElement("div");
                                var text = document.createElement("span");
                                text.textContent = ctg + ' - ' + persentage + '%';
                                var circle = document.createElement("div");
                                circle.classList.add('circle')
                                circle.style.background = this.colors[pIndex % this.colors.length]

                                li.classList.add('info__element')
                                li.style.padding = "7.5px 0";
                                li.append(circle)
                                li.append(text)
                                legend.append(li);
                            }
                            pIndex++;
                        }
                    } else {
                        let ctg = this.options.data.main + '%'
                        this.ctx.fillStyle = "#000";
                        this.ctx.font = "bold 20px Mont";
                        var summs = 0;
                        for(ctg in this.options.data) {
                            summs += this.options.data[ctg]
                        }
                        for (let ctg of Object.keys(this.options.data)) {
                            if(ctg !== 'maxValue') {
                                let persentage = (this.options.data[ctg] * 100) / summs
                                if(persentage > 0 && persentage < 1)
                                    persentage = ((this.options.data[ctg] * 100) / summs).toFixed(2)
                                else if (this.options.data[ctg] == 0)
                                    persentage = '0'
                                else
                                    persentage = Math.round(persentage)
                                persentage = persentage.toString();
                                var li = document.createElement("div");
                                var text = document.createElement("span");
                                text.textContent = ctg;
                                var circle = document.createElement("div");
                                circle.classList.add('circle')
                                circle.style.background = this.colors[pIndex % this.colors.length]

                                li.classList.add('info__element')
                                li.style.padding = "7.5px 0";
                                let newSpan = document.createElement('span')

                                var secondText = document.createElement("span");
                                secondText.classList.add('result')
                                secondText.textContent = persentage + '%';

                                newSpan.append(circle)
                                newSpan.append(text)
                                li.append(newSpan)
                                li.append(secondText)
                                legend.append(li);
                            }
                            pIndex++;
                        }
                    }
                }

                this.draw = function() {
                    this.drawSlices();
                    if(this.options.title)
                        this.drawTitle();
                    this.drawLabels();
                    this.drawLegend();
                }
            }

            var myCanvas = document.getElementById("myCanvas");
            myCanvas.width = 600;
            myCanvas.height = 300;
            
            var ctx = myCanvas.getContext("2d");

            var meta = document.getElementById("meta");
            meta.width = 850;
            meta.height = 200;

            var ctxMeta = meta.getContext("2d");

            var seoOnPage = document.getElementById("seoOnPage");
            seoOnPage.width = 300;
            seoOnPage.height = 300;
            
            var ctxSeoOnPage = seoOnPage.getContext("2d");

            var page = document.getElementById("pages");
            page.width = 293;
            page.height = 300;

            var ctxPage = page.getContext("2d");

            var index = document.getElementById("index");
            index.width = 300;
            index.height = 300;

            var ctxIndex = index.getContext("2d");

            var images = document.getElementById("images");
            images.width = 300;
            images.height = 300;

            var ctxImages = images.getContext("2d");

            var commerce = document.getElementById("commerce");
            commerce.width = 200;
            commerce.height = 250;

            var ctxCommerce = commerce.getContext("2d");

            let unique = <?=$seotable['META_TITLE_UNIQUE']?> + <?=$seotable['META_DESC_UNIQUE']?> + <?=$seotable['META_H1_UNIQUE']?>;
            let metaObjSum = {
                META_TITLE_UNIQUE: <?=$seotable['META_TITLE_UNIQUE']?>,
                META_DESC_UNIQUE: <?=$seotable['META_DESC_UNIQUE']?>,
                META_H1_UNIQUE: <?=$seotable['META_H1_UNIQUE']?>,
                META_TITLE_NOUNIQUE: <?=$seotable['META_TITLE_NOUNIQUE']?>,
                META_DESC_NOUNIQUE: <?=$seotable['META_DESC_NOUNIQUE']?>,
                META_H1_NOUNIQUE: <?=$seotable['META_H1_NOUNIQUE']?>,
                META_EMPTY: <?=$seotable['META_EMPTY']?>,
                META_DESC_EMPTY: <?=$seotable['META_DESC_EMPTY']?>,
                META_H1_EMPTY: <?=$seotable['META_H1_EMPTY']?>,
            };
            metaObjSum = sum(metaObjSum);
            let metaResult = Math.round((unique * 100) / metaObjSum)
            if(metaObjSum == 0)
                metaResult = 0
                

            var analysis = {
                "SEO onPage": Math.round((<?=count($seoOnPage['NORMAL']) ?? 0?> * 100) / <?=count($seoOnPage['ALL']) !== 0 ? count($seoOnPage['ALL']) : 1?>),
                "Коммерция": <?=$seotable['SUMMARY_COMMERCE']?>,
                "Индексация": Math.round((<?=$seotable['PAGES_INDEX']?> * 100) / <?=$seotable['SUMMARY_INDEX'] !== 0 ? $seotable['SUMMARY_INDEX'] : 1?>),
                "Мета-теги": metaResult,
                "Изображения": <?=$summaryImages?>,
            };
            
            var myBarchart = new Barchart(
                {
                    canvas:myCanvas,
                    seriesName:"Сводка",
                    id:'myCanvas',
                    padding:30,
                    maxValue: 100,
                    radiusAr: {
                        tl: 15,
                        tr: 15,
                        br: 0,
                        bl: 0
                    },
                    gridScale:5,
                    gridColor:"#fff",
                    data:analysis,
                    colors:["#285FFA", "#6D94FF", "#BCCEFF", "#1D55F5", "#5A85FF"]
                }
            );
            myBarchart.draw();

            var metaObj = {
                'Title': {
                    'Уникальные': <?=$seotable['META_TITLE_UNIQUE']?>,
                    'Дублирующиеся': <?=$seotable['META_TITLE_NOUNIQUE']?>,
                    'Пустые/отсутствующие': <?=$seotable['META_EMPTY']?>,
                },
                'Description': {
                    'Уникальные': <?=$seotable['META_DESC_UNIQUE']?>,
                    'Дублирующиеся': <?=$seotable['META_DESC_NOUNIQUE']?>,
                    'Пустые/отсутствующие': <?=$seotable['META_DESC_EMPTY']?>,
                },
                'H1': {
                    'Уникальные': <?=$seotable['META_H1_UNIQUE']?>,
                    'Дублирующиеся': <?=$seotable['META_H1_NOUNIQUE']?>,
                    'Пустые/отсутствующие': <?=$seotable['META_H1_EMPTY']?>,
                },
            };
            
            var Meta = new Barchart(
                {
                    canvas:meta,
                    seriesName:"",
                    id:'meta',
                    padding:30,
                    gridScale:5,
                    horizontal: true,
                    gridColor:"#fff",
                    data:metaObj,
                    colors:["#5A85FF", "#BCCEFF", "#285FFA"]
                }
            );
            Meta.draw();
            
            var seoOnPageObj = {
                "Товары": <?=count($seoOnPage['GOODS'])?>,
                "Услуги": <?=count($seoOnPage['SERVICE'])?>,
                "Статьи": <?=count($seoOnPage['NEWS'])?>,
            };

            var seoOnPageCanv = new PieChart(
                {
                    canvas:seoOnPage,
                    seriesName:"Seo OnPage",
                    padding:30,
                    id: 'seoOnPage',
                    gridScale:5,
                    gridColor:"#fff",
                    doughnutHoleSize: 0.2,
                    holeText: true,
                    data:seoOnPageObj,
                    colors:["#5A85FF", "#BCCEFF", "#285FFA"],
                    titleOptions: {
                        align: "center",
                        fill: "black",
                        font: {
                            weight: "bold",
                            size: "18px",
                            family: "Lato"
                        }
                    }
                }
            );
            seoOnPageCanv.draw();
            
            var pageObj = {
                "Индексируемые": <?=$seotable['PAGES_INDEX']?>,
                "Неиндексируемые": <?=$seotable['PAGES_NOINDEX']?>,
                "4ХХ страницы": <?=$seotable['PAGES_ERROR']?>,
            };

            var Page = new PieChart(
                {
                    canvas:page,
                    seriesName:["<?=$seotable['SUMMARY_INDEX']?>", 'HTML страниц'],
                    id: 'pages',
                    padding:30,
                    gridScale:5,
                    gridColor:"#fff",
                    doughnutHoleSize: 0.7,
                    holeText: true,
                    data:pageObj,
                    colors:["#5A85FF", "#BCCEFF", "#285FFA"],
                    title: true,
                    titleOptions: {
                        align: "center",
                        fill: "black",
                        font: {
                            weight: "bold",
                            size: "18px",
                            family: "Lato"
                        }
                    }
                }
            );
            Page.draw();

            var indexObj = {
                "Закрыты в robots.txt": <?=$seotable['INDEX_CLOSED']?>,
                "Закрыты в мета теге robots": <?=$seotable['INDEX_META_ROBOTS']?>,
                "Сanonical": <?=$seotable['INDEX_CANONICAL']?>,
                "страницы не 2ХХ": <?=$seotable['INDEX_NOT_GET']?>,
                'maxValue': <?=$seotable['PAGES_INDEX']?>
            };

            var Index = new PieChart(
                {
                    canvas:index,
                    seriesName:"",
                    id: 'index',
                    padding:30,
                    gridScale:5,
                    gridColor:"#fff",
                    data:indexObj,
                    doughnutHoleSize: 0.2,
                    holeText: true,
                    colors:["#6D94FF", "#BCCEFF", "#285FFA", "#5A85FF", "#F9FAFE"],
                    titleOptions: {
                        align: "center",
                        fill: "black",
                        font: {
                            weight: "bold",
                            size: "18px",
                            family: "Lato"
                        }
                    }
                }
            );
            Index.draw();

            var imagesObj = {
                "Изображения без alt": <?=$seotable['IMAGES_NO_ALT']?>,
                "Изображения без title": <?=$seotable['IMAGES_NO_TITLE']?>,
                "Img с максимальным размером": <?=$seotable['IMAGES_MAX_SIZE']?>,
                'maxValue': <?=$seotable['IMAGES_ALL']?>
            };

            var Images = new PieChart(
                {
                    canvas:images,
                    seriesName:["<?=$seotable['IMAGES_ALL']?>", "Всего изображений"],
                    id: 'images',
                    padding:30,
                    gridScale:5,
                    gridColor:"#fff",
                    title: true,
                    data:imagesObj,
                    doughnutHoleSize: 0.7,
                    holeText: true,
                    colors:["#6D94FF", "#BCCEFF", "#285FFA", "#F9FAFE"],
                    titleOptions: {
                        align: "center",
                        fill: "black",
                        font: {
                            weight: "bold",
                            size: "18px",
                            family: "Lato"
                        }
                    }
                }
            );
            Images.draw();

            var commerceObj = {
                "change": 100 - (<?=$seotable['COMMERCE']?> * 2),
                "main": <?=$seotable['COMMERCE']?> * 2,
            };

            var Commerce = new PieChart(
                {
                    canvas:commerce,
                    seriesName:"",
                    id: 'commerce',
                    padding:0,
                    gridScale:5,
                    gridColor:"#fff",
                    data:commerceObj,
                    doughnutHoleSize: 0.7,
                    colors:["#F9FAFE", "rgba(40, 95, 250, 0.75)"],
                    titleOptions: {
                        align: "center",
                        fill: "black",
                        font: {
                            weight: "bold",
                            size: "18px",
                            family: "Lato"
                        }
                    }
                }
            );
            Commerce.draw();

            let btn = document.querySelectorAll('.element__btn .download__btn');
            for (let i = 0; i < btn.length; i++) {
                btn[i].addEventListener('click', function() {
                    var data, name = false
                    switch (i) {
                        case 0:
                            data = <?=$data['SEO OnPage']?>;
                            name = 'SEO OnPage';
                            break;
                        case 1:
                            data = <?=$data['Страницы']?>;
                            name = 'Страницы';
                            break;
                        case 2:
                            data = <?=$data['Мета теги']?>;
                            name = 'Мета теги';
                            break;
                        case 3:
                            data = <?=$data['Индексация']?>;
                            name = 'Индексация';
                            break;
                        case 4:
                            data = <?=$data['Изображения']?>;
                            name = 'Изображения';
                            break;
                        case 5:
                            data = <?=$data['Коммерция']?>;
                            name = 'Коммерция';
                            break;
                        default:
                            break;
                    }
                    if(data) {
                        for (let j = 0; j < data.length; j++) {
                            for (let k in data[j]) {
                                if(typeof data[j][k] == 'object' && data[j][k]) {
                                    data[j][k] = Object.values(data[j][k])
                                    data[j][k] = data[j][k].join(', ')
                                }
                            }
                        }
                        const worksheet = XLSX.utils.json_to_sheet(data);
                        const workbook = XLSX.utils.book_new();
                        XLSX.utils.book_append_sheet(workbook, worksheet, name);
                        XLSX.writeFile(workbook, name + ".xlsx");
                    }
                })
            }

            document.addEventListener("DOMContentLoaded", function() {
                document.querySelector('#allPDF').addEventListener('click', function() {
                    let analysis = document.querySelector('#analysis > .main')
                    html2canvas(analysis).then((canvas) => {
                        let a = document.createElement("a");
                        a.download = "info.png";
                        a.href = canvas.toDataURL("image/png");
                        a.click();
                    });
                })
            })
        </script>
    <?endif;?>
    <style>
        #analysis {
            position: relative;
            font-family: 'Mont';
            font-style: normal;
            font-size: 16px;
        }
        #analysis .element__content.circle {
            align-items: flex-start;
        }
        #analysis .header, #analysis .main__group, #analysis .element__content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        #analysis legend .info__element {
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            line-height: 20px;
        }
        #analysis .element__content {
            min-height: 180px;
        }
        #analysis .content__title {
            position: absolute;
            transform: rotate(-90deg);
            left: -6.25%;
        }
        #analysis .element__title {
            position: relative;
        }
        #analysis .element__title, #analysis .header .date, #analysis .header .download, #analysis a.download__btn {
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-weight: 550;
            font-size: 16px;
            line-height: 16px;
        }
        #analysis .header {
            margin-bottom: 15px;
        }
        #analysis a.download__btn {
            color: #fff;
            text-decoration: none;
        }
        #analysis .main__line {
            margin-bottom: 20px;
            width: 100%;
            height: 1px;
            background: #A4B9CC;
        }
        #analysis .main__group {
            align-items: baseline;
            margin-bottom: 20px;
        }
        #analysis .header .date svg, #analysis a.download__btn svg {
            margin-right: 10px;
        }
        #analysis .download__btn.download__xls, #analysis .download__btn.download__check, #analysis .download__btn.download__btn__instructions {
            margin-right: 30px;
        }
        #analysis .download__btn {
            padding: 10px 25px;
            background-color: #8EB339;
            border-radius: 5px;
            cursor: pointer;
        }
        #analysis .main .download__btn {
            background-color: #fff;
            color: #285FFA;
            border: 1px solid rgba(40, 95, 250, 0.4);
        }
        #analysis .download__btn:hover {
            background: #a4b974;
        }
        #analysis .main .download__btn:hover {
            background: rgba(40, 95, 250, 0.4);
            color: #fff;
        }
        #analysis .main .download__btn:hover path {
            fill: #fff;
        }
        #analysis .download__btn.download__check {
            padding: 10px 40px;
        }
        #analysis legend#title {
            font-weight: 550;
            font-size: 12px;
            line-height: 12px;
        }
        #analysis .main__element {
            background-color: #fff;
            padding: 20px 25px;
            position: relative;
            height: 320px;
            margin-right: 30px;
        }
        #analysis .main__group .main__element:last-of-type {
            margin: 0;
        }
        #analysis legend.circle {
            min-width: 200px;
            padding-top: 30px;
        }
        #analysis legend.circle .info__element .circle {
            min-height: 7px;
            min-width: 7px;
            border-radius: 50%;
            margin-right: 10px;
        }
        #analysis .element__btn .download__btn {
            width: fit-content;
        }
        #analysis .element__btn {
            display: flex;
            justify-content: flex-end;
            position: absolute;
            bottom: 25px;
            right: 25px;
        }
        #analysis .info__title {
            padding: 5px 0;
            border-bottom: 1px solid #000;
        }
        #analysis .info__title .title__value {
            font-weight: 900;
        }
        #analysis .element__content.circle.commerce {
            flex-direction: column;
            align-items: center;
            height: calc(100% - 20px);
        }
        #analysis .commerce .element__btn {
            position: static;;
        }
        #analysis .commerce .download__btn {
            margin: 0;
        }
        #analysis .element__content.meta {
            flex-direction: column;
            align-items: start;
        }
        #analysis .element__content.meta .content__info {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
        }
        #analysis .element__content.meta .content__info .element__text {
            display: flex;
            flex-direction: column;
        }
        #analysis .element__content.meta .content__info > .info__element {
            flex-direction: column;
            align-items: flex-start;
        }
        #analysis .element__content.meta .element__btn {
            position: static;
        }
        #analysis .element__content.meta .element__btn .download__btn {
            margin: 0 0 0 30px;
        }
        #analysis .download__check > a {
            line-height: 20px;
        }
        #analysis #summary, #analysis #metaElement {
            width: 56%;
        }
        #analysis legend[for="myCanvas"] .info__element {
            margin-bottom: 13px;
        }
        #analysis legend[for="meta"] div.info__element {
            padding: 7.5px !important;
        }
        #analysis legend[for="meta"] span.info__element {
            margin-bottom: 5px;
        }
        #analysis .main__element {
            width: 35%;
        }
        #analysis .content__canvas#meta {
            align-self: center;
        }
        #analysis .element__popup {
            position: absolute;
            padding: 10px;
            text-align: center;
            right: 0;
            top: 35px;
            background: #e5eef0;
            border-radius: 10px;
            z-index: -1;
            opacity: 0;
            width: max-content;
            transition: ease-in-out 0.2s;
            cursor: default;
        }
        #analysis .element__label {
            cursor: pointer;
        }
        #analysis .element__label:hover .element__popup {
            z-index: 1000;
            opacity: 1;
        }
        #analysis .date__text {
            margin-right: 30px;
        }
        #analysis .info__element span {
            display: flex;
            align-items: center;
            font-weight: 500;
            font-size: 12px;
            line-height: 15px;
            color: #000000
        }
        #analysis .info__element span.legend__head {
            font-weight: 700;
            font-size: 10px;
            line-height: 13px;
            color: #BDBFCB;
        }
        #analysis .info__element span.result {
            font-weight: 900;
        }
        #analysis #summary legend.circle {
            min-width: unset;
            width: 20%;
        }
        #analysis .main__element.commerce {
            width: 15%;
        }
    </style>
<?
}
$APPLICATION->SetTitle('Общая сводка по оптимизации сайта');
require($_SERVER["DOCUMENT_ROOT"]."/bitrix/modules/main/include/epilog_admin.php");
?>